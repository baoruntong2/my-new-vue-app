var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,n=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&o(e,a,t[a]);if(l)for(var a of l(t))s.call(t,a)&&o(e,a,t[a]);return e},i=(e,t,a)=>new Promise((l,r)=>{var s=e=>{try{n(a.next(e))}catch(t){r(t)}},o=e=>{try{n(a.throw(e))}catch(t){r(t)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(s,o);n((a=a.apply(e,t)).next())});import{v as d,j as u,r as c,a as m,b as v,c as p,l as g,t as y,F as b,z as x,n as h,B as f,C as w,D as k,E as C,m as L,G as j,u as M,s as A,H as S,I as V,y as $,x as I,J as P,K as D,L as B,h as U}from"./vue-vendor-4f5e579f.js";import{u as z}from"./accountStore-88a5190b.js";import{a as H}from"./api-f0b2653a.js";import{_ as R}from"./index-6eedd0a1.js";import{u as _}from"./authStore-7202ba10.js";import"./axios-a8f987cd.js";const O=()=>i(void 0,null,function*(){try{const e=yield H.get("/loans/pre-approved");return(null==e?void 0:e.data)||e}catch(e){return{amount:5e4,rate:4.35,message:"基于您的账户信息，我们为您评估了预授信额度"}}}),F=()=>i(void 0,null,function*(){try{const e=yield H.get("/loans/my-loans");return(null==e?void 0:e.data)||e}catch(e){return[]}}),T=e=>i(void 0,null,function*(){try{const t=yield H.post("/loans/consumer/apply",e);return(null==t?void 0:t.data)||t}catch(t){throw new Error("申请失败，请稍后重试")}}),E=e=>i(void 0,null,function*(){try{const t=yield H.post("/loans/large/pre-apply",e);return(null==t?void 0:t.data)||t}catch(t){throw new Error("预审申请失败，请稍后重试")}}),N=(e,t)=>i(void 0,null,function*(){try{const a=new FormData;t.forEach((e,t)=>{a.append(`document_${t}`,e.file),a.append(`type_${t}`,e.type)});const l=yield H.post(`/loans/${e}/documents`,a,{headers:{"Content-Type":"multipart/form-data"}});return(null==l?void 0:l.data)||l}catch(a){throw new Error("材料上传失败，请稍后重试")}}),X=e=>i(void 0,null,function*(){try{const t=yield H.get("/loans/managers",{params:e});return(null==t?void 0:t.data)||t}catch(t){return[{id:"1",name:"李经理",phone:"13800138001",branch:"总行营业部",address:"北京市朝阳区XX路XX号",distance:1.2,specialty:["房贷","车贷"],rating:4.8},{id:"2",name:"王经理",phone:"13800138002",branch:"海淀支行",address:"北京市海淀区XX路XX号",distance:2.5,specialty:["房贷"],rating:4.9},{id:"3",name:"张经理",phone:"13800138003",branch:"西城支行",address:"北京市西城区XX路XX号",distance:3.8,specialty:["车贷"],rating:4.7}]}}),q=e=>i(void 0,null,function*(){try{const t=yield H.post("/loans/appointments",e);return(null==t?void 0:t.data)||t}catch(t){throw new Error("预约失败，请稍后重试")}}),W=()=>i(void 0,null,function*(){try{const e=yield H.get("/housing-fund/info");return(null==e?void 0:e.data)||e}catch(e){return{balance:125680.5,monthlyDeposit:2400,loanLimit:8e5,accountNumber:"1101234567890123456",status:"active",lastUpdateDate:(new Date).toISOString()}}}),Y=e=>i(void 0,null,function*(){try{const t=yield H.post("/housing-fund/withdraw",e);return(null==t?void 0:t.data)||t}catch(t){throw new Error("提取申请失败，请稍后重试")}}),G=(e,t)=>i(void 0,null,function*(){try{const a=yield H.post(`/loans/${e}/repay`,t);return(null==a?void 0:a.data)||a}catch(a){throw new Error("还款失败，请稍后重试")}}),J=(e,t)=>i(void 0,null,function*(){try{const a=yield H.post(`/loans/${e}/schedule-repay`,t);return(null==a?void 0:a.data)||a}catch(a){throw new Error("预约还款失败，请稍后重试")}}),K=e=>i(void 0,null,function*(){try{const t=yield H.get(`/loans/${e}/repayment-history`);return(null==t?void 0:t.data)||t}catch(t){throw new Error("获取还款记录失败，请稍后重试")}}),Q=e=>i(void 0,null,function*(){try{const t=yield H.get(`/loans/${e}/progress`);return(null==t?void 0:t.data)||t}catch(t){throw new Error("获取贷款进度失败，请稍后重试")}}),Z=d("loan",{state:()=>({myLoans:[],preApprovedAmount:0,preApprovedRate:0,currentApplication:null,housingFundInfo:{balance:0,monthlyDeposit:0,loanLimit:0,accountNumber:"",status:"active"},managers:[],isLoading:!1,error:null}),actions:{fetchPreApprovedAmount(){return i(this,null,function*(){try{this.isLoading=!0;const e=yield O();return this.preApprovedAmount=e.amount||0,this.preApprovedRate=e.rate||0,e}catch(e){throw this.error=e.message||"获取预授信额度失败",e}finally{this.isLoading=!1}})},fetchMyLoans(){return i(this,null,function*(){try{this.isLoading=!0;const e=yield F();return this.myLoans=e||[],this.myLoans}catch(e){throw this.error=e.message||"获取贷款列表失败",e}finally{this.isLoading=!1}})},applyConsumerLoan(e){return i(this,null,function*(){try{this.isLoading=!0;const t=yield T(e);return this.currentApplication=t,t}catch(t){throw this.error=t.message||"申请失败",t}finally{this.isLoading=!1}})},applyLargeLoan(e){return i(this,null,function*(){try{this.isLoading=!0;const t=yield E(e);return this.currentApplication=t,t}catch(t){throw this.error=t.message||"预审申请失败",t}finally{this.isLoading=!1}})},uploadLoanDocuments(e,t){return i(this,null,function*(){try{this.isLoading=!0;return yield N(e,t)}catch(a){throw this.error=a.message||"材料上传失败",a}finally{this.isLoading=!1}})},fetchManagers(e){return i(this,null,function*(){try{this.isLoading=!0;const t=yield X(e);return this.managers=t||[],this.managers}catch(t){throw this.error=t.message||"获取客户经理列表失败",t}finally{this.isLoading=!1}})},bookAppointment(e){return i(this,null,function*(){try{this.isLoading=!0;return yield q(e)}catch(t){throw this.error=t.message||"预约失败",t}finally{this.isLoading=!1}})},fetchHousingFundInfo(){return i(this,null,function*(){try{this.isLoading=!0;const e=yield W();return this.housingFundInfo={balance:e.balance||0,monthlyDeposit:e.monthlyDeposit||0,loanLimit:e.loanLimit||0,accountNumber:e.accountNumber||"",status:e.status||"active"},this.housingFundInfo}catch(e){throw this.error=e.message||"获取公积金信息失败",e}finally{this.isLoading=!1}})},applyHousingFundWithdrawal(e){return i(this,null,function*(){try{this.isLoading=!0;return yield Y(e)}catch(t){throw this.error=t.message||"提取申请失败",t}finally{this.isLoading=!1}})},repayLoan(e,t){return i(this,null,function*(){try{this.isLoading=!0;const a=yield G(e,t);return yield this.fetchMyLoans(),a}catch(a){throw this.error=a.message||"还款失败",a}finally{this.isLoading=!1}})},scheduleRepayment(e,t){return i(this,null,function*(){try{this.isLoading=!0;return yield J(e,t)}catch(a){throw this.error=a.message||"预约还款失败",a}finally{this.isLoading=!1}})},fetchRepaymentHistory(e){return i(this,null,function*(){try{this.isLoading=!0;return yield K(e)}catch(t){throw this.error=t.message||"获取还款记录失败",t}finally{this.isLoading=!1}})},fetchLoanProgress(e){return i(this,null,function*(){try{this.isLoading=!0;return yield Q(e)}catch(t){throw this.error=t.message||"获取贷款进度失败",t}finally{this.isLoading=!1}})},clearError(){this.error=null}},getters:{activeLoans:e=>e.myLoans.filter(e=>"closed"!==e.status&&"settled"!==e.status),totalPendingAmount:e=>e.myLoans.filter(e=>"closed"!==e.status&&"settled"!==e.status).reduce((e,t)=>e+(t.pendingAmount||0),0),nextRepaymentDate:e=>{const t=e.myLoans.filter(e=>"closed"!==e.status&&"settled"!==e.status);if(0===t.length)return null;const a=t.map(e=>e.nextRepaymentDate).filter(Boolean);return 0===a.length?null:new Date(Math.min(...a.map(e=>new Date(e))))}}}),ee={class:"space-y-6"},te={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ae={class:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white shadow-lg"},le={class:"text-3xl font-bold"},re={class:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white shadow-lg"},se={class:"text-3xl font-bold"},oe={class:"bg-gradient-to-br from-amber-500 to-amber-600 rounded-xl p-6 text-white shadow-lg"},ne={class:"text-2xl font-bold"},ie={key:0,class:"space-y-4"},de={class:"flex items-start justify-between mb-4"},ue={class:"flex-1"},ce={class:"flex items-center mb-2"},me={class:"text-lg font-semibold text-gray-800 mr-3"},ve={class:"text-sm text-gray-500"},pe=["onClick"],ge={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},ye={class:"text-base font-semibold text-gray-800"},be={class:"text-base font-semibold text-gray-800"},xe={class:"text-base font-semibold text-gray-800"},he={class:"text-base font-semibold text-primary"},fe={class:"flex items-center gap-3 pt-4 border-t border-gray-100"},we=["onClick"],ke=["onClick"],Ce=["onClick"],Le={key:1,class:"text-center py-12 bg-white rounded-xl border border-gray-200"},je={class:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto"},Me={key:0,class:"space-y-4"},Ae={class:"bg-gray-50 rounded-lg p-4"},Se={class:"font-semibold text-gray-800"},Ve={class:"text-sm text-gray-500 mt-2"},$e={class:"space-y-2"},Ie={key:0},Pe=["max"],De={key:1},Be={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Ue={class:"text-2xl font-bold text-blue-900"},ze=["value"],He={class:"flex gap-3"},Re=["disabled"],_e={class:"bg-white rounded-xl p-6 max-w-md w-full"},Oe={key:0,class:"space-y-4"},Fe={class:"bg-gray-50 rounded-lg p-4"},Te={class:"font-semibold text-gray-800"},Ee={class:"text-sm text-gray-500 mt-2"},Ne={class:"text-sm text-gray-500"},Xe=["min"],qe=["value"],We={class:"flex gap-3"},Ye=["disabled"],Ge={class:"bg-white rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Je={key:0,class:"space-y-3"},Ke={class:"flex items-center justify-between mb-2"},Qe={class:"font-semibold text-gray-800"},Ze={class:"text-sm text-gray-500"},et={class:"text-right"},tt={class:"text-lg font-bold text-primary"},at={class:"grid grid-cols-3 gap-4 text-sm text-gray-600 pt-2 border-t border-gray-100"},lt={class:"font-medium"},rt={class:"font-medium"},st={class:"font-medium"},ot={key:1,class:"text-center py-8 text-gray-500"},nt=R({__name:"MyLoans",setup(e){const t=Z(),a=z(),l=u(()=>t.activeLoans),r=u(()=>t.totalPendingAmount),s=u(()=>t.nextRepaymentDate),o=u(()=>a.userInfo.accounts||[]),n=u(()=>s.value?O(s.value):"暂无"),d=c(!1),A=c(null),S=c("partial"),V=c(0),$=c(""),I=c(!1),P=c(""),D=c(""),B=c(!1),U=c([]),H=u(()=>{const e=new Date;return e.setDate(e.getDate()+7),e.toISOString().split("T")[0]}),R=u(()=>{var e;return!!$.value&&("partial"!==S.value||V.value>=1e3&&V.value<=((null==(e=A.value)?void 0:e.remainingPrincipal)||0))}),_=u(()=>P.value&&D.value),O=e=>{if(!e)return"-";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},F=e=>({pending:"审批中",approved:"已放款",active:"还款中",overdue:"逾期",closed:"已结清",settled:"已结清"}[e]||e),T=()=>{if(!A.value)return 0;const e=A.value.remainingPrincipal||0,t=.05*e,a=e>1e5?.001*e:0;return Math.round(e+t+a)},E=()=>{d.value=!1,A.value=null,V.value=0,$.value=""},N=()=>i(this,null,function*(){try{const e="full"===S.value?T():V.value;yield t.repayLoan(A.value.id,{type:S.value,amount:e,accountId:$.value}),window.$notify.success({title:"还款成功",message:`已成功还款 ¥${e.toLocaleString()}`,duration:5e3}),E()}catch(e){window.$notify.error({title:"还款失败",message:e.message||"还款操作失败，请稍后重试",duration:5e3})}}),X=()=>{I.value=!1,A.value=null,P.value="",D.value=""},q=()=>i(this,null,function*(){try{yield t.scheduleRepayment(A.value.id,{date:P.value,accountId:D.value,amount:A.value.nextRepaymentAmount}),window.$notify.success({title:"预约成功",message:`已成功预约 ${O(P.value)} 自动还款`,duration:5e3}),X()}catch(e){window.$notify.error({title:"预约失败",message:e.message||"预约操作失败，请稍后重试",duration:5e3})}}),W=e=>i(this,null,function*(){try{const a=yield t.fetchRepaymentHistory(e);U.value=a||[],B.value=!0}catch(a){window.$notify.error({title:"获取失败",message:a.message||"获取还款记录失败",duration:5e3})}}),Y=()=>{B.value=!1,U.value=[]};return m(()=>i(this,null,function*(){try{yield t.fetchMyLoans(),yield a.fetchUserInfo()}catch(e){}})),(e,t)=>(v(),p("div",ee,[g("div",te,[g("div",ae,[t[6]||(t[6]=g("div",{class:"flex items-center justify-between mb-2"},[g("span",{class:"text-blue-100 text-sm"},"总待还金额"),g("svg",{class:"w-6 h-6 text-blue-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),g("p",le,"¥"+y(r.value.toLocaleString()),1)]),g("div",re,[t[7]||(t[7]=g("div",{class:"flex items-center justify-between mb-2"},[g("span",{class:"text-green-100 text-sm"},"未结清贷款"),g("svg",{class:"w-6 h-6 text-green-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),g("p",se,y(l.value.length)+" 笔",1)]),g("div",oe,[t[8]||(t[8]=g("div",{class:"flex items-center justify-between mb-2"},[g("span",{class:"text-amber-100 text-sm"},"下一还款日"),g("svg",{class:"w-6 h-6 text-amber-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),g("p",ne,y(n.value),1)])]),l.value.length>0?(v(),p("div",ie,[t[13]||(t[13]=g("h3",{class:"text-lg font-semibold text-gray-800"},"我的贷款",-1)),(v(!0),p(b,null,x(l.value,e=>{return v(),p("div",{key:e.id,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow"},[g("div",de,[g("div",ue,[g("div",ce,[g("h4",me,y(e.productName),1),g("span",{class:h(["px-2 py-1 text-xs rounded-full",(a=e.status,{pending:"bg-amber-100 text-amber-800",approved:"bg-blue-100 text-blue-800",active:"bg-green-100 text-green-800",overdue:"bg-red-100 text-red-800",closed:"bg-gray-100 text-gray-800",settled:"bg-gray-100 text-gray-800"}[a]||"bg-gray-100 text-gray-800")])},y(F(e.status)),3)]),g("p",ve,"贷款编号："+y(e.loanNumber),1)]),g("button",{onClick:t=>{e.id},class:"text-primary hover:text-primary/80 text-sm font-medium"}," 查看详情 ",8,pe)]),g("div",ge,[g("div",null,[t[9]||(t[9]=g("p",{class:"text-xs text-gray-500 mb-1"},"贷款金额",-1)),g("p",ye,"¥"+y(e.amount.toLocaleString()),1)]),g("div",null,[t[10]||(t[10]=g("p",{class:"text-xs text-gray-500 mb-1"},"剩余本金",-1)),g("p",be,"¥"+y(e.remainingPrincipal.toLocaleString()),1)]),g("div",null,[t[11]||(t[11]=g("p",{class:"text-xs text-gray-500 mb-1"},"下一还款日",-1)),g("p",xe,y(O(e.nextRepaymentDate)),1)]),g("div",null,[t[12]||(t[12]=g("p",{class:"text-xs text-gray-500 mb-1"},"应还金额",-1)),g("p",he,"¥"+y(e.nextRepaymentAmount.toLocaleString()),1)])]),g("div",fe,[g("button",{onClick:t=>(e=>{var t;A.value=e,S.value="partial",V.value=Math.min(1e4,e.remainingPrincipal),$.value=(null==(t=o.value[0])?void 0:t.id)||"",d.value=!0})(e),class:"flex-1 bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors font-medium"}," 立即还款 ",8,we),g("button",{onClick:t=>(e=>{var t;A.value=e,P.value="",D.value=(null==(t=o.value[0])?void 0:t.id)||"",I.value=!0})(e),class:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors font-medium"}," 预约还款 ",8,ke),g("button",{onClick:t=>W(e.id),class:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors"}," 还款记录 ",8,Ce)])]);var a}),128))])):(v(),p("div",Le,[...t[14]||(t[14]=[g("svg",{class:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),g("p",{class:"text-gray-500 text-lg mb-2"},"暂无未结清贷款",-1),g("p",{class:"text-gray-400 text-sm"},"您可以在上方选择贷款产品进行申请",-1)])])),d.value?(v(),p("div",{key:2,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:f(E,["self"])},[g("div",je,[g("div",{class:"flex items-center justify-between mb-4"},[t[16]||(t[16]=g("h3",{class:"text-lg font-semibold text-gray-800"},"还款",-1)),g("button",{onClick:E,class:"text-gray-400 hover:text-gray-600"},[...t[15]||(t[15]=[g("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),A.value?(v(),p("div",Me,[g("div",Ae,[t[17]||(t[17]=g("p",{class:"text-sm text-gray-500 mb-1"},"贷款产品",-1)),g("p",Se,y(A.value.productName),1),g("p",Ve,"剩余本金：¥"+y(A.value.remainingPrincipal.toLocaleString()),1)]),g("div",null,[t[20]||(t[20]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"还款类型",-1)),g("div",$e,[g("label",{class:h(["flex items-center p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50","partial"===S.value?"border-primary bg-primary/5":"border-gray-200"])},[w(g("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=e=>S.value=e),value:"partial",class:"text-primary focus:ring-primary"},null,512),[[k,S.value]]),t[18]||(t[18]=g("div",{class:"ml-3 flex-1"},[g("p",{class:"font-medium text-gray-800"},"部分提前还款"),g("p",{class:"text-xs text-gray-500"},"提前偿还部分本金，减少后续利息")],-1))],2),g("label",{class:h(["flex items-center p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50","full"===S.value?"border-primary bg-primary/5":"border-gray-200"])},[w(g("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=e=>S.value=e),value:"full",class:"text-primary focus:ring-primary"},null,512),[[k,S.value]]),t[19]||(t[19]=g("div",{class:"ml-3 flex-1"},[g("p",{class:"font-medium text-gray-800"},"全部结清"),g("p",{class:"text-xs text-gray-500"},"一次性还清所有本金和利息")],-1))],2)])]),"partial"===S.value?(v(),p("div",Ie,[t[21]||(t[21]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"还款金额（元）",-1)),w(g("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>V.value=e),min:1e3,max:A.value.remainingPrincipal,step:"100",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"请输入还款金额"},null,8,Pe),[[C,V.value,void 0,{number:!0}]]),t[22]||(t[22]=g("p",{class:"text-xs text-gray-500 mt-1"},"最低还款金额：¥1,000",-1))])):L("",!0),"full"===S.value?(v(),p("div",De,[g("div",Be,[t[23]||(t[23]=g("p",{class:"text-sm text-blue-800 mb-2"},"预计结清金额",-1)),g("p",Ue,"¥"+y(T().toLocaleString()),1),t[24]||(t[24]=g("p",{class:"text-xs text-blue-600 mt-1"},"包含本金、利息及可能的手续费",-1))])])):L("",!0),g("div",null,[t[26]||(t[26]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"还款账户",-1)),w(g("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>$.value=e),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[t[25]||(t[25]=g("option",{value:""},"请选择还款账户",-1)),(v(!0),p(b,null,x(o.value,e=>(v(),p("option",{key:e.id,value:e.id},y(e.name)+" ("+y(e.number)+") ",9,ze))),128))],512),[[j,$.value]])]),t[27]||(t[27]=M('<div class="bg-amber-50 border-l-4 border-amber-400 rounded-lg p-4" data-v-f1ac4a56><div class="flex" data-v-f1ac4a56><svg class="w-5 h-5 text-amber-500 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-f1ac4a56><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-f1ac4a56></path></svg><div class="text-sm text-amber-700" data-v-f1ac4a56><p class="font-medium mb-1" data-v-f1ac4a56>温馨提示</p><p data-v-f1ac4a56>提前还款可能需要支付一定手续费，具体费用以实际计算为准。还款成功后，剩余本金和利息将重新计算。</p></div></div></div>',1)),g("div",He,[g("button",{onClick:E,class:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," 取消 "),g("button",{onClick:N,disabled:!R.value,class:"flex-1 bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 确认还款 ",8,Re)])])):L("",!0)])])):L("",!0),I.value?(v(),p("div",{key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:f(X,["self"])},[g("div",_e,[g("div",{class:"flex items-center justify-between mb-4"},[t[29]||(t[29]=g("h3",{class:"text-lg font-semibold text-gray-800"},"预约还款",-1)),g("button",{onClick:X,class:"text-gray-400 hover:text-gray-600"},[...t[28]||(t[28]=[g("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),A.value?(v(),p("div",Oe,[g("div",Fe,[t[30]||(t[30]=g("p",{class:"text-sm text-gray-500 mb-1"},"贷款产品",-1)),g("p",Te,y(A.value.productName),1),g("p",Ee,"下一还款日："+y(O(A.value.nextRepaymentDate)),1),g("p",Ne,"应还金额：¥"+y(A.value.nextRepaymentAmount.toLocaleString()),1)]),g("div",null,[t[31]||(t[31]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"预约还款日期",-1)),w(g("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=e=>P.value=e),min:H.value,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},null,8,Xe),[[C,P.value]]),t[32]||(t[32]=g("p",{class:"text-xs text-gray-500 mt-1"},"请选择未来7-30天内的日期",-1))]),g("div",null,[t[34]||(t[34]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"还款账户",-1)),w(g("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>D.value=e),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[t[33]||(t[33]=g("option",{value:""},"请选择还款账户",-1)),(v(!0),p(b,null,x(o.value,e=>(v(),p("option",{key:e.id,value:e.id},y(e.name)+" ("+y(e.number)+") ",9,qe))),128))],512),[[j,D.value]])]),t[35]||(t[35]=M('<div class="bg-blue-50 border-l-4 border-blue-400 rounded-lg p-4" data-v-f1ac4a56><div class="flex" data-v-f1ac4a56><svg class="w-5 h-5 text-blue-500 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-f1ac4a56><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-f1ac4a56></path></svg><p class="text-sm text-blue-700" data-v-f1ac4a56>系统将在预约日期自动从指定账户扣款，请确保账户余额充足。</p></div></div>',1)),g("div",We,[g("button",{onClick:X,class:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," 取消 "),g("button",{onClick:q,disabled:!_.value,class:"flex-1 bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 确认预约 ",8,Ye)])])):L("",!0)])])):L("",!0),B.value?(v(),p("div",{key:4,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:f(Y,["self"])},[g("div",Ge,[g("div",{class:"flex items-center justify-between mb-4"},[t[37]||(t[37]=g("h3",{class:"text-lg font-semibold text-gray-800"},"还款记录",-1)),g("button",{onClick:Y,class:"text-gray-400 hover:text-gray-600"},[...t[36]||(t[36]=[g("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),U.value.length>0?(v(),p("div",Je,[(v(!0),p(b,null,x(U.value,e=>(v(),p("div",{key:e.id,class:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors"},[g("div",Ke,[g("div",null,[g("p",Qe,y(O(e.repayDate)),1),g("p",Ze,y("normal"===e.type?"正常还款":"partial"===e.type?"部分提前还款":"全部结清"),1)]),g("div",et,[g("p",tt,"¥"+y(e.amount.toLocaleString()),1),g("p",{class:h(["text-xs text-gray-500","success"===e.status?"text-green-600":"text-gray-500"])},y("success"===e.status?"还款成功":"pending"===e.status?"处理中":"失败"),3)])]),g("div",at,[g("div",null,[t[38]||(t[38]=g("span",{class:"text-gray-500"},"本金：",-1)),g("span",lt,"¥"+y(e.principal.toLocaleString()),1)]),g("div",null,[t[39]||(t[39]=g("span",{class:"text-gray-500"},"利息：",-1)),g("span",rt,"¥"+y(e.interest.toLocaleString()),1)]),g("div",null,[t[40]||(t[40]=g("span",{class:"text-gray-500"},"手续费：",-1)),g("span",st,"¥"+y((e.fee||0).toLocaleString()),1)])])]))),128))])):(v(),p("div",ot," 暂无还款记录 "))])])):L("",!0)]))}},[["__scopeId","data-v-f1ac4a56"]]),it={class:"space-y-6"},dt={key:0,class:"bg-gradient-to-r from-primary to-primary/80 rounded-xl p-6 text-white shadow-lg"},ut={class:"flex items-center justify-between mb-4"},ct={class:"text-4xl font-bold mb-2"},mt={class:"text-white/90 text-sm"},vt={key:1,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm space-y-6"},pt={class:"flex items-center justify-between mb-6"},gt={class:"flex items-center flex-1"},yt={class:"flex items-center"},bt={class:"flex items-center"},xt={class:"flex items-center"},ht={key:0,class:"space-y-4"},ft={class:"relative"},wt=["max"],kt={class:"text-xs text-gray-500 mt-1"},Ct={class:"grid grid-cols-3 gap-3"},Lt=["onClick"],jt=["value"],Mt=["value"],At={class:"bg-blue-50 border-l-4 border-blue-400 rounded-lg p-4"},St={class:"flex"},Vt={class:"text-sm text-blue-700"},$t={class:"text-lg font-bold"},It={class:"flex items-start"},Pt=["disabled"],Dt={key:1,class:"space-y-4"},Bt={class:"flex gap-3"},Ut=["disabled"],zt={class:"text-xs text-gray-500 mt-1"},Ht={class:"flex gap-3"},Rt=["disabled"],_t={key:2,class:"space-y-4"},Ot={key:0,class:"text-center"},Ft={class:"bg-gray-50 rounded-lg p-6 mb-6 text-left"},Tt={class:"space-y-3 text-sm"},Et={class:"flex justify-between"},Nt={class:"font-semibold text-gray-800"},Xt={class:"flex justify-between"},qt={class:"font-semibold text-gray-800"},Wt={class:"flex justify-between"},Yt={class:"font-semibold text-gray-800"},Gt={class:"flex justify-between"},Jt={class:"font-semibold text-gray-800"},Kt={class:"flex items-start mb-6"},Qt=["disabled"],Zt={key:1,class:"text-center"},ea={key:2,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm text-center"},ta={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},aa={class:"text-sm text-blue-800"},la=R({__name:"ConsumerLoan",setup(e){const t=Z(),a=z(),l=_(),r=c(null),s=c(!1),o=c(!1),n=c(1),d=c(0),f=u(()=>{var e;return(null==(e=l.userInfo)?void 0:e.phone)||"138****8888"}),k=u(()=>a.userInfo.accounts||[]),V=[{value:3,label:"3个月"},{value:6,label:"6个月"},{value:12,label:"12个月"}],$=c({amount:0,term:3,receiveAccount:"",repayAccount:"",agreeTerms:!1,verifyCode:"",agreeContract:!1}),I=c(null),P=c(""),D=u(()=>{var e;if(!$.value.amount||!$.value.term)return 0;const t=((null==(e=r.value)?void 0:e.rate)||4.35)/100/12,a=$.value.term,l=Math.pow(1+t,a);return Math.round($.value.amount*t*l/(l-1))}),B=u(()=>{var e;return $.value.amount>=1e3&&$.value.amount<=((null==(e=r.value)?void 0:e.amount)||5e4)&&$.value.term&&$.value.receiveAccount&&$.value.repayAccount&&$.value.agreeTerms}),U=()=>{var e,t,a;s.value=!0,n.value=1,$.value.amount=Math.min(1e4,(null==(e=r.value)?void 0:e.amount)||1e4),$.value.receiveAccount=(null==(t=k.value[0])?void 0:t.id)||"",$.value.repayAccount=(null==(a=k.value[0])?void 0:a.id)||""},H=()=>{1===n.value&&B.value&&(n.value=2)},R=()=>{n.value>1&&n.value--},O=()=>i(this,null,function*(){try{d.value=60;const e=setInterval(()=>{d.value--,d.value<=0&&clearInterval(e)},1e3);window.$notify.success({title:"验证码已发送",message:`验证码已发送至 ${f.value}`,duration:3e3})}catch(e){window.$notify.error({title:"发送失败",message:"验证码发送失败，请稍后重试",duration:5e3})}}),F=()=>i(this,null,function*(){var e;try{if("123456"!==$.value.verifyCode)return void window.$notify.error({title:"验证失败",message:"验证码错误，请重新输入",duration:5e3});yield t.applyConsumerLoan({amount:$.value.amount,term:$.value.term,receiveAccount:$.value.receiveAccount,repayAccount:$.value.repayAccount});const a=Math.random()>.3;I.value={status:a?"approved":"pending",amount:$.value.amount,rate:(null==(e=r.value)?void 0:e.rate)||4.35,term:`${$.value.term}个月`,monthlyPayment:D.value},n.value=3}catch(a){window.$notify.error({title:"申请失败",message:a.message||"申请提交失败，请稍后重试",duration:5e3})}}),T=()=>i(this,null,function*(){try{P.value=`LOAN${Date.now()}`,window.$notify.success({title:"签约成功",message:"资金将在T+0分钟内划拨至您的收款账户",duration:5e3}),s.value=!1,o.value=!0,yield t.fetchMyLoans()}catch(e){window.$notify.error({title:"签约失败",message:e.message||"签约操作失败，请稍后重试",duration:5e3})}}),E=()=>{s.value=!1,o.value=!1,n.value=1,$.value={amount:0,term:3,receiveAccount:"",repayAccount:"",agreeTerms:!1,verifyCode:"",agreeContract:!1},I.value=null,P.value=""};return m(()=>i(this,null,function*(){try{yield t.fetchPreApprovedAmount(),r.value={amount:t.preApprovedAmount,rate:t.preApprovedRate},yield a.fetchUserInfo()}catch(e){}})),(e,t)=>{var a,l;return v(),p("div",it,[r.value?(v(),p("div",dt,[g("div",ut,[g("div",null,[t[6]||(t[6]=g("p",{class:"text-white/80 text-sm mb-1"},"您的预授信额度",-1)),g("p",ct,"¥"+y(r.value.amount.toLocaleString()),1),g("p",mt,"年利率低至 "+y(r.value.rate)+"%",1)]),t[7]||(t[7]=g("svg",{class:"w-16 h-16 text-white/30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1))]),g("button",{onClick:U,class:"bg-white text-primary px-6 py-2 rounded-lg font-semibold hover:bg-white/90 transition-colors"}," 立即申请 ")])):L("",!0),s.value?(v(),p("div",vt,[t[28]||(t[28]=g("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"消费贷款申请",-1)),g("div",pt,[g("div",gt,[g("div",yt,[g("div",{class:h(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold",n.value>=1?"bg-primary text-white":"bg-gray-200 text-gray-500"])}," 1 ",2),g("span",{class:h(["ml-2 text-sm",n.value>=1?"text-primary font-medium":"text-gray-500"])},"填写信息",2)]),g("div",{class:h(["flex-1 h-0.5 mx-4",n.value>=2?"bg-primary":"bg-gray-200"])},null,2),g("div",bt,[g("div",{class:h(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold",n.value>=2?"bg-primary text-white":"bg-gray-200 text-gray-500"])}," 2 ",2),g("span",{class:h(["ml-2 text-sm",n.value>=2?"text-primary font-medium":"text-gray-500"])},"身份验证",2)]),g("div",{class:h(["flex-1 h-0.5 mx-4",n.value>=3?"bg-primary":"bg-gray-200"])},null,2),g("div",xt,[g("div",{class:h(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold",n.value>=3?"bg-primary text-white":"bg-gray-200 text-gray-500"])}," 3 ",2),g("span",{class:h(["ml-2 text-sm",n.value>=3?"text-primary font-medium":"text-gray-500"])},"确认签约",2)])])]),1===n.value?(v(),p("div",ht,[g("div",null,[t[9]||(t[9]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("借款金额（元）"),g("span",{class:"text-red-500"},"*")],-1)),g("div",ft,[w(g("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=e=>$.value.amount=e),min:1e3,max:(null==(a=r.value)?void 0:a.amount)||5e4,step:"1000",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"请输入借款金额"},null,8,wt),[[C,$.value.amount,void 0,{number:!0}]]),t[8]||(t[8]=g("span",{class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500"},"元",-1))]),g("p",kt,"可借额度：¥1,000 - ¥"+y(((null==(l=r.value)?void 0:l.amount)||5e4).toLocaleString()),1)]),g("div",null,[t[10]||(t[10]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("借款期限"),g("span",{class:"text-red-500"},"*")],-1)),g("div",Ct,[(v(),p(b,null,x(V,e=>g("button",{key:e.value,onClick:t=>$.value.term=e.value,class:h(["px-4 py-2 border-2 rounded-lg transition-all",$.value.term===e.value?"border-primary bg-primary/5 text-primary font-medium":"border-gray-200 hover:border-gray-300"])},y(e.label),11,Lt)),64))])]),g("div",null,[t[12]||(t[12]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("收款账户"),g("span",{class:"text-red-500"},"*")],-1)),w(g("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>$.value.receiveAccount=e),class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[t[11]||(t[11]=g("option",{value:""},"请选择收款账户",-1)),(v(!0),p(b,null,x(k.value,e=>(v(),p("option",{key:e.id,value:e.id},y(e.name)+" ("+y(e.number)+") ",9,jt))),128))],512),[[j,$.value.receiveAccount]])]),g("div",null,[t[14]||(t[14]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("还款账户"),g("span",{class:"text-red-500"},"*")],-1)),w(g("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>$.value.repayAccount=e),class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[t[13]||(t[13]=g("option",{value:""},"请选择还款账户",-1)),(v(!0),p(b,null,x(k.value,e=>(v(),p("option",{key:e.id,value:e.id},y(e.name)+" ("+y(e.number)+") ",9,Mt))),128))],512),[[j,$.value.repayAccount]])]),g("div",At,[g("div",St,[t[16]||(t[16]=g("svg",{class:"w-5 h-5 text-blue-500 mr-3 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),g("div",Vt,[t[15]||(t[15]=g("p",{class:"font-medium mb-1"},"预计月还款额",-1)),g("p",$t,"¥"+y(D.value.toLocaleString()),1)])])]),g("div",It,[w(g("input",{type:"checkbox",id:"agreeTerms","onUpdate:modelValue":t[3]||(t[3]=e=>$.value.agreeTerms=e),class:"mt-1 h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[S,$.value.agreeTerms]]),t[17]||(t[17]=g("label",{for:"agreeTerms",class:"ml-2 text-sm text-gray-700"},[A(" 我已阅读并同意 "),g("a",{href:"#",class:"text-primary hover:underline"},"《消费贷款服务协议》"),A(" 和 "),g("a",{href:"#",class:"text-primary hover:underline"},"《个人信息授权书》")],-1))]),g("button",{onClick:H,disabled:!B.value,class:"w-full bg-primary text-white px-6 py-3 rounded-lg font-semibold hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 下一步：身份验证 ",8,Pt)])):L("",!0),2===n.value?(v(),p("div",Dt,[t[19]||(t[19]=M('<div class="text-center mb-6" data-v-94c1a69b><div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4" data-v-94c1a69b><svg class="w-8 h-8 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-94c1a69b><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" data-v-94c1a69b></path></svg></div><h4 class="text-lg font-semibold text-gray-800 mb-2" data-v-94c1a69b>身份验证</h4><p class="text-sm text-gray-500" data-v-94c1a69b>为了保障您的账户安全，请完成身份验证</p></div>',1)),g("div",null,[t[18]||(t[18]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"手机验证码",-1)),g("div",Bt,[w(g("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>$.value.verifyCode=e),maxlength:"6",class:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"请输入6位验证码"},null,512),[[C,$.value.verifyCode]]),g("button",{onClick:O,disabled:d.value>0,class:"px-6 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},y(d.value>0?`${d.value}秒`:"发送验证码"),9,Ut)]),g("p",zt,"验证码将发送至手机号："+y(f.value),1)]),g("div",Ht,[g("button",{onClick:R,class:"flex-1 border border-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-50 transition-colors"}," 上一步 "),g("button",{onClick:F,disabled:!$.value.verifyCode||6!==$.value.verifyCode.length,class:"flex-1 bg-primary text-white px-6 py-3 rounded-lg font-semibold hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 验证并提交 ",8,Rt)])])):L("",!0),3===n.value?(v(),p("div",_t,["approved"===I.value.status?(v(),p("div",Ot,[t[26]||(t[26]=M('<div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4" data-v-94c1a69b><svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-94c1a69b><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-v-94c1a69b></path></svg></div><h4 class="text-xl font-semibold text-gray-800 mb-2" data-v-94c1a69b>审批通过</h4><p class="text-sm text-gray-500 mb-6" data-v-94c1a69b>恭喜！您的贷款申请已通过审批</p>',3)),g("div",Ft,[t[24]||(t[24]=g("h5",{class:"font-semibold text-gray-800 mb-4"},"合同信息",-1)),g("div",Tt,[g("div",Et,[t[20]||(t[20]=g("span",{class:"text-gray-600"},"贷款金额：",-1)),g("span",Nt,"¥"+y(I.value.amount.toLocaleString()),1)]),g("div",Xt,[t[21]||(t[21]=g("span",{class:"text-gray-600"},"年利率：",-1)),g("span",qt,y(I.value.rate)+"%",1)]),g("div",Wt,[t[22]||(t[22]=g("span",{class:"text-gray-600"},"借款期限：",-1)),g("span",Yt,y(I.value.term),1)]),g("div",Gt,[t[23]||(t[23]=g("span",{class:"text-gray-600"},"月还款额：",-1)),g("span",Jt,"¥"+y(I.value.monthlyPayment.toLocaleString()),1)])])]),g("div",Kt,[w(g("input",{type:"checkbox",id:"agreeContract","onUpdate:modelValue":t[5]||(t[5]=e=>$.value.agreeContract=e),class:"mt-1 h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[S,$.value.agreeContract]]),t[25]||(t[25]=g("label",{for:"agreeContract",class:"ml-2 text-sm text-gray-700"}," 我已阅读并同意上述合同条款，确认无误后进行电子签名 ",-1))]),g("button",{onClick:T,disabled:!$.value.agreeContract,class:"w-full bg-primary text-white px-6 py-3 rounded-lg font-semibold hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 确认签约 ",8,Qt)])):"pending"===I.value.status?(v(),p("div",Zt,[t[27]||(t[27]=M('<div class="w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4" data-v-94c1a69b><svg class="w-8 h-8 text-amber-600 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-94c1a69b><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" data-v-94c1a69b></path></svg></div><h4 class="text-xl font-semibold text-gray-800 mb-2" data-v-94c1a69b>审核中</h4><p class="text-sm text-gray-500 mb-6" data-v-94c1a69b>您的申请已进入人工审核流程，预计2小时内告知结果</p>',3)),g("button",{onClick:E,class:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"}," 返回首页 ")])):L("",!0)])):L("",!0)])):L("",!0),o.value?(v(),p("div",ea,[t[30]||(t[30]=M('<div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4" data-v-94c1a69b><svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-94c1a69b><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-v-94c1a69b></path></svg></div><h3 class="text-2xl font-bold text-gray-800 mb-2" data-v-94c1a69b>签约成功</h3><p class="text-gray-600 mb-6" data-v-94c1a69b>资金将在T+0分钟内划拨至您的收款账户</p>',3)),g("div",ta,[g("p",aa,[t[29]||(t[29]=g("span",{class:"font-semibold"},"贷款编号：",-1)),A(y(P.value),1)])]),g("button",{onClick:E,class:"bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors"}," 返回我的贷款 ")])):L("",!0)])}}},[["__scopeId","data-v-94c1a69b"]]),ra={class:"space-y-6"},sa={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},oa={class:"flex items-center mb-3"},na={class:"flex items-center mb-3"},ia={key:0,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm space-y-6"},da={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ua={class:"block text-sm font-medium text-gray-700 mb-2"},ca={class:"relative"},ma=["placeholder"],va={class:"flex gap-2"},pa=["onClick"],ga={key:0,class:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6"},ya={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},ba={class:"text-lg font-bold text-gray-800"},xa={class:"text-lg font-bold text-primary"},ha={class:"text-lg font-bold text-gray-800"},fa={class:"text-lg font-bold text-gray-800"},wa={class:"border-t border-gray-200 pt-6"},ka={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ca={class:"flex items-start"},La=["disabled"],ja={key:1,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Ma={key:0,class:"text-center"},Aa={key:1,class:"text-center"},Sa={class:"text-gray-600 mb-4"},Va={class:"text-left text-sm text-gray-600 mb-6 space-y-2"},$a={key:2,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Ia={class:"space-y-4"},Pa={class:"flex items-center justify-between mb-2"},Da={class:"font-medium text-gray-800"},Ba={class:"text-xs text-gray-500"},Ua={key:0,class:"text-xs text-red-500"},za={class:"mt-3"},Ha=["id","onChange"],Ra=["for"],_a={key:0,class:"ml-3 text-sm text-green-600"},Oa={class:"flex gap-3 pt-4"},Fa=["disabled"],Ta={key:3,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Ea={class:"space-y-4"},Na=["onClick"],Xa={class:"flex items-start justify-between"},qa={class:"flex-1"},Wa={class:"flex items-center mb-2"},Ya={class:"font-semibold text-gray-800 mr-3"},Ga={class:"flex items-center text-yellow-500"},Ja={class:"ml-1 text-sm"},Ka={class:"text-sm text-gray-600 mb-1"},Qa={class:"text-sm text-gray-500"},Za={class:"text-sm text-gray-500 mt-1"},el={class:"flex flex-wrap gap-2 mt-2"},tl={class:"ml-4"},al=["checked"],ll={class:"mt-6 flex gap-3"},rl=["disabled"],sl={key:4,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},ol={class:"space-y-4"},nl=["value"],il=["min"],dl={class:"grid grid-cols-4 gap-2"},ul=["onClick"],cl={class:"flex gap-3 pt-4"},ml=["disabled"],vl={key:5,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},pl={class:"space-y-4"},gl={class:"flex flex-col items-center mr-4"},yl={class:"flex-1"},bl={class:"font-medium text-gray-800"},xl={class:"text-sm text-gray-500 mt-1"},hl={key:0,class:"text-xs text-gray-400 mt-1"},fl=R({__name:"LargeLoan",setup(e){const l=Z(),r=c(""),s="house"===r.value?[20,30,40,50]:[20,30,40],o=c({totalPrice:0,downPaymentRatio:(r.value,30),name:"张三",idCard:"",phone:"13800138000",age:30,occupation:"",monthlyIncome:0,authorizeCredit:!1}),d=c(null),f=c(!1),I=c({}),P=u(()=>"house"===r.value?[{type:"idCard",name:"身份证",description:"正反面",required:!0},{type:"incomeProof",name:"收入证明",description:"近6个月银行流水或工资单",required:!0},{type:"socialSecurity",name:"社保记录",description:"近12个月社保缴费记录",required:!1},{type:"houseContract",name:"购房合同",description:"商品房买卖合同或认购书",required:!0}]:[{type:"idCard",name:"身份证",description:"正反面",required:!0},{type:"incomeProof",name:"收入证明",description:"近6个月银行流水或工资单",required:!0},{type:"carContract",name:"购车合同",description:"车辆认购书或购车协议",required:!0}]),D=c([]),B=c(!1),U=c(null),z=c(!1),H=c({branchId:"",date:"",time:""}),R=["09:00","10:00","11:00","14:00","15:00","16:00","17:00"],_=c(null),O=c([]),F=u(()=>o.value.totalPrice&&o.value.downPaymentRatio?Math.round(o.value.totalPrice*o.value.downPaymentRatio/100):0),T=u(()=>o.value.totalPrice-F.value),E=u(()=>"house"===r.value?4.35:5.5),N=u(()=>{if(!T.value)return 0;const e=E.value/100/12,t=Math.pow(1+e,360);return Math.round(T.value*e*t/(t-1))}),X=u(()=>{const e=new Date;return e.setDate(e.getDate()+1),e.toISOString().split("T")[0]}),q=u(()=>o.value.totalPrice>0&&o.value.downPaymentRatio&&o.value.name&&o.value.idCard&&o.value.phone&&o.value.age>=18&&o.value.occupation&&o.value.monthlyIncome>0&&o.value.authorizeCredit),W=u(()=>P.value.filter(e=>e.required).every(e=>I.value[e.type])),Y=u(()=>H.value.branchId&&H.value.date&&H.value.time),G=()=>i(this,null,function*(){try{const i=yield l.applyLargeLoan((e=n({type:r.value},o.value),s={loanAmount:T.value},t(e,a(s))));d.value=i,"approved"===i.status&&(f.value=!0,yield K())}catch(i){window.$notify.error({title:"预审失败",message:i.message||"预审申请失败，请稍后重试",duration:5e3})}var e,s}),J=()=>i(this,null,function*(){try{_.value||(_.value=`LOAN${Date.now()}`);const e=Object.entries(I.value).map(([e,t])=>({type:e,file:t}));yield l.uploadLoanDocuments(_.value,e),window.$notify.success({title:"提交成功",message:"材料已提交，客户经理将在24小时内进行初审",duration:5e3}),f.value=!1,B.value=!0,yield te()}catch(e){window.$notify.error({title:"提交失败",message:e.message||"材料提交失败，请稍后重试",duration:5e3})}}),K=()=>i(this,null,function*(){try{const e=yield l.fetchManagers({type:r.value,city:"北京"});D.value=e}catch(e){}}),Q=()=>{B.value=!1,z.value=!0},ee=()=>i(this,null,function*(){try{yield l.bookAppointment(n({loanId:_.value,managerId:U.value.id},H.value)),window.$notify.success({title:"预约成功",message:`已成功预约 ${H.value.date} ${H.value.time} 面签`,duration:5e3}),z.value=!1,yield te()}catch(e){window.$notify.error({title:"预约失败",message:e.message||"预约失败，请稍后重试",duration:5e3})}}),te=()=>i(this,null,function*(){if(_.value)try{const e=yield l.fetchLoanProgress(_.value);O.value=e.steps||[{status:"submitted",title:"材料已提交",description:"等待客户经理初审",completed:!0,current:!1,date:(new Date).toISOString()},{status:"reviewing",title:"审批中",description:"银行正在审核您的申请",completed:!1,current:!0},{status:"approved",title:"审批通过",description:"等待放款",completed:!1,current:!1},{status:"disbursed",title:"已放款",description:"资金已划拨至指定账户",completed:!1,current:!1}]}catch(e){}});return V(r,e=>{e&&(o.value.downPaymentRatio=30)},{immediate:!1}),m(()=>{}),(e,t)=>(v(),p("div",ra,[g("div",sa,[g("div",{class:h(["p-6 border-2 rounded-xl cursor-pointer transition-all hover:shadow-md","house"===r.value?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"]),onClick:t[1]||(t[1]=e=>r.value="house")},[g("div",oa,[w(g("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),value:"house",class:"text-primary focus:ring-primary"},null,512),[[k,r.value]]),t[19]||(t[19]=g("h3",{class:"ml-3 text-lg font-semibold text-gray-800"},"住房按揭贷款",-1))]),t[20]||(t[20]=g("p",{class:"text-sm text-gray-600"},"购买商品房、二手房等住房贷款",-1))],2),g("div",{class:h(["p-6 border-2 rounded-xl cursor-pointer transition-all hover:shadow-md","car"===r.value?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"]),onClick:t[3]||(t[3]=e=>r.value="car")},[g("div",na,[w(g("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e),value:"car",class:"text-primary focus:ring-primary"},null,512),[[k,r.value]]),t[21]||(t[21]=g("h3",{class:"ml-3 text-lg font-semibold text-gray-800"},"汽车消费贷款",-1))]),t[22]||(t[22]=g("p",{class:"text-sm text-gray-600"},"购买新车、二手车等汽车贷款",-1))],2)]),r.value?(v(),p("div",ia,[t[40]||(t[40]=g("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"贷款预申请",-1)),g("div",da,[g("div",null,[g("label",ua,[A(y("house"===r.value?"房产总价（元）":"车辆价格（元）"),1),t[23]||(t[23]=g("span",{class:"text-red-500"},"*",-1))]),g("div",ca,[w(g("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>o.value.totalPrice=e),min:"0",step:"1000",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"house"===r.value?"请输入房产总价":"请输入车辆价格"},null,8,ma),[[C,o.value.totalPrice,void 0,{number:!0}]]),t[24]||(t[24]=g("span",{class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500"},"元",-1))])]),g("div",null,[t[25]||(t[25]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("首付比例"),g("span",{class:"text-red-500"},"*")],-1)),g("div",va,[(v(!0),p(b,null,x($(s),e=>(v(),p("button",{key:e,onClick:t=>o.value.downPaymentRatio=e,class:h(["flex-1 px-4 py-2 border-2 rounded-lg transition-all",o.value.downPaymentRatio===e?"border-primary bg-primary/5 text-primary font-medium":"border-gray-200 hover:border-gray-300"])},y(e)+"% ",11,pa))),128))])])]),o.value.totalPrice&&o.value.downPaymentRatio?(v(),p("div",ga,[t[30]||(t[30]=g("h4",{class:"font-semibold text-gray-800 mb-4"},"贷款测算结果",-1)),g("div",ya,[g("div",null,[t[26]||(t[26]=g("p",{class:"text-xs text-gray-500 mb-1"},"首付金额",-1)),g("p",ba,"¥"+y(F.value.toLocaleString()),1)]),g("div",null,[t[27]||(t[27]=g("p",{class:"text-xs text-gray-500 mb-1"},"可贷金额",-1)),g("p",xa,"¥"+y(T.value.toLocaleString()),1)]),g("div",null,[t[28]||(t[28]=g("p",{class:"text-xs text-gray-500 mb-1"},"参考利率",-1)),g("p",ha,y(E.value)+"%",1)]),g("div",null,[t[29]||(t[29]=g("p",{class:"text-xs text-gray-500 mb-1"},"预计月供",-1)),g("p",fa,"¥"+y(N.value.toLocaleString()),1)])])])):L("",!0),g("div",wa,[t[38]||(t[38]=g("h4",{class:"font-semibold text-gray-800 mb-4"},"个人信息",-1)),g("div",ka,[g("div",null,[t[31]||(t[31]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("姓名"),g("span",{class:"text-red-500"},"*")],-1)),w(g("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>o.value.name=e),class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"请输入姓名"},null,512),[[C,o.value.name]])]),g("div",null,[t[32]||(t[32]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("身份证号"),g("span",{class:"text-red-500"},"*")],-1)),w(g("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=e=>o.value.idCard=e),maxlength:"18",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"请输入身份证号"},null,512),[[C,o.value.idCard]])]),g("div",null,[t[33]||(t[33]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("手机号"),g("span",{class:"text-red-500"},"*")],-1)),w(g("input",{type:"tel","onUpdate:modelValue":t[7]||(t[7]=e=>o.value.phone=e),maxlength:"11",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"请输入手机号"},null,512),[[C,o.value.phone]])]),g("div",null,[t[34]||(t[34]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("年龄"),g("span",{class:"text-red-500"},"*")],-1)),w(g("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=e=>o.value.age=e),min:"18",max:"65",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"请输入年龄"},null,512),[[C,o.value.age,void 0,{number:!0}]])]),g("div",null,[t[36]||(t[36]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("职业"),g("span",{class:"text-red-500"},"*")],-1)),w(g("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>o.value.occupation=e),class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[...t[35]||(t[35]=[M('<option value="" data-v-94b828c8>请选择职业</option><option value="employee" data-v-94b828c8>企业员工</option><option value="civil-servant" data-v-94b828c8>公务员</option><option value="teacher" data-v-94b828c8>教师</option><option value="doctor" data-v-94b828c8>医生</option><option value="self-employed" data-v-94b828c8>个体工商户</option><option value="other" data-v-94b828c8>其他</option>',7)])],512),[[j,o.value.occupation]])]),g("div",null,[t[37]||(t[37]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("月收入（元）"),g("span",{class:"text-red-500"},"*")],-1)),w(g("input",{type:"number","onUpdate:modelValue":t[10]||(t[10]=e=>o.value.monthlyIncome=e),min:"0",step:"100",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"请输入月收入"},null,512),[[C,o.value.monthlyIncome,void 0,{number:!0}]])])])]),g("div",Ca,[w(g("input",{type:"checkbox",id:"authorizeCredit","onUpdate:modelValue":t[11]||(t[11]=e=>o.value.authorizeCredit=e),class:"mt-1 h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[S,o.value.authorizeCredit]]),t[39]||(t[39]=g("label",{for:"authorizeCredit",class:"ml-2 text-sm text-gray-700"}," 我已授权银行查询我的征信记录用于贷款审批 ",-1))]),g("button",{onClick:G,disabled:!q.value,class:"w-full bg-primary text-white px-6 py-3 rounded-lg font-semibold hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 提交预申请 ",8,La)])):L("",!0),d.value?(v(),p("div",ja,["approved"===d.value.status?(v(),p("div",Ma,[t[41]||(t[41]=M('<div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4" data-v-94b828c8><svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-94b828c8><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-v-94b828c8></path></svg></div><h4 class="text-xl font-semibold text-gray-800 mb-2" data-v-94b828c8>预审通过</h4><p class="text-gray-600 mb-6" data-v-94b828c8>恭喜！您的贷款预审已通过，请上传相关材料</p>',3)),g("button",{onClick:t[12]||(t[12]=e=>f.value=!0),class:"bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors"}," 上传材料 ")])):(v(),p("div",Aa,[t[43]||(t[43]=g("div",{class:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4"},[g("svg",{class:"w-8 h-8 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),t[44]||(t[44]=g("h4",{class:"text-xl font-semibold text-gray-800 mb-2"},"建议补充材料",-1)),g("p",Sa,y(d.value.message),1),g("ul",Va,[(v(!0),p(b,null,x(d.value.suggestions,e=>(v(),p("li",{key:e,class:"flex items-start"},[t[42]||(t[42]=g("span",{class:"text-primary mr-2"},"•",-1)),g("span",null,y(e),1)]))),128))]),g("button",{onClick:t[13]||(t[13]=e=>f.value=!0),class:"bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90 transition-colors"}," 上传补充材料 ")]))])):L("",!0),f.value?(v(),p("div",$a,[t[46]||(t[46]=g("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"材料上传",-1)),g("div",Ia,[(v(!0),p(b,null,x(P.value,e=>(v(),p("div",{key:e.type,class:"border border-gray-200 rounded-lg p-4"},[g("div",Pa,[g("div",null,[g("p",Da,y(e.name),1),g("p",Ba,y(e.description),1)]),e.required?(v(),p("span",Ua,"必填")):L("",!0)]),g("div",za,[g("input",{type:"file",id:`file-${e.type}`,onChange:t=>((e,t)=>{const a=e.target.files[0];a&&(I.value[t]=a)})(t,e.type),accept:"image/*,.pdf",class:"hidden"},null,40,Ha),g("label",{for:`file-${e.type}`,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors"},[...t[45]||(t[45]=[g("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),A(" 选择文件 ",-1)])],8,Ra),I.value[e.type]?(v(),p("span",_a," ✓ "+y(I.value[e.type].name),1)):L("",!0)])]))),128)),g("div",Oa,[g("button",{onClick:t[14]||(t[14]=e=>f.value=!1),class:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," 取消 "),g("button",{onClick:J,disabled:!W.value,class:"flex-1 bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 提交材料 ",8,Fa)])])])):L("",!0),B.value?(v(),p("div",Ta,[t[48]||(t[48]=g("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"选择客户经理",-1)),g("div",Ea,[(v(!0),p(b,null,x(D.value,e=>{var a,l;return v(),p("div",{key:e.id,class:h(["border-2 rounded-lg p-4 cursor-pointer transition-all hover:shadow-md",(null==(a=U.value)?void 0:a.id)===e.id?"border-primary bg-primary/5":"border-gray-200"]),onClick:t=>U.value=e},[g("div",Xa,[g("div",qa,[g("div",Wa,[g("h5",Ya,y(e.name),1),g("div",Ga,[t[47]||(t[47]=g("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[g("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1)),g("span",Ja,y(e.rating),1)])]),g("p",Ka,y(e.branch),1),g("p",Qa,y(e.address),1),g("p",Za,"距离您约 "+y(e.distance)+"km",1),g("div",el,[(v(!0),p(b,null,x(e.specialty,e=>(v(),p("span",{key:e,class:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded"},y(e),1))),128))])]),g("div",tl,[g("input",{type:"radio",checked:(null==(l=U.value)?void 0:l.id)===e.id,class:"text-primary focus:ring-primary"},null,8,al)])])],10,Na)}),128))]),g("div",ll,[g("button",{onClick:t[15]||(t[15]=e=>B.value=!1),class:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," 取消 "),g("button",{onClick:Q,disabled:!U.value,class:"flex-1 bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 确认选择 ",8,rl)])])):L("",!0),z.value?(v(),p("div",sl,[t[53]||(t[53]=g("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"预约面签",-1)),g("div",ol,[g("div",null,[t[50]||(t[50]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"选择网点",-1)),w(g("select",{"onUpdate:modelValue":t[16]||(t[16]=e=>H.value.branchId=e),class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[t[49]||(t[49]=g("option",{value:""},"请选择网点",-1)),(v(!0),p(b,null,x(D.value,e=>(v(),p("option",{key:e.id,value:e.id},y(e.branch)+" - "+y(e.address),9,nl))),128))],512),[[j,H.value.branchId]])]),g("div",null,[t[51]||(t[51]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"选择日期",-1)),w(g("input",{type:"date","onUpdate:modelValue":t[17]||(t[17]=e=>H.value.date=e),min:X.value,class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},null,8,il),[[C,H.value.date]])]),g("div",null,[t[52]||(t[52]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"选择时间",-1)),g("div",dl,[(v(),p(b,null,x(R,e=>g("button",{key:e,onClick:t=>H.value.time=e,class:h(["px-3 py-2 border-2 rounded-lg transition-all text-sm",H.value.time===e?"border-primary bg-primary/5 text-primary font-medium":"border-gray-200 hover:border-gray-300"])},y(e),11,ul)),64))])]),g("div",cl,[g("button",{onClick:t[18]||(t[18]=e=>z.value=!1),class:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," 取消 "),g("button",{onClick:ee,disabled:!Y.value,class:"flex-1 bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 确认预约 ",8,ml)])])])):L("",!0),_.value?(v(),p("div",vl,[t[54]||(t[54]=g("h4",{class:"text-lg font-semibold text-gray-800 mb-4"},"贷款进度",-1)),g("div",pl,[(v(!0),p(b,null,x(O.value,(e,t)=>(v(),p("div",{key:e.status,class:"flex items-start"},[g("div",gl,[g("div",{class:h(["w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold",e.completed?"bg-primary text-white":e.current?"bg-primary/20 text-primary border-2 border-primary":"bg-gray-200 text-gray-500"])},y(e.completed?"✓":t+1),3),t<O.value.length-1?(v(),p("div",{key:0,class:h(["w-0.5 h-12 mt-2",e.completed?"bg-primary":"bg-gray-200"])},null,2)):L("",!0)]),g("div",yl,[g("p",bl,y(e.title),1),g("p",xl,y(e.description),1),e.date?(v(),p("p",hl,y(e.date),1)):L("",!0)])]))),128))])])):L("",!0)]))}},[["__scopeId","data-v-94b828c8"]]),wl={class:"space-y-6"},kl={key:0,class:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white shadow-lg"},Cl={class:"flex items-center justify-between mb-4"},Ll={class:"text-4xl font-bold mb-2"},jl={class:"text-white/90 text-sm"},Ml={class:"grid grid-cols-2 gap-4 mt-4"},Al={class:"bg-white/20 rounded-lg p-3"},Sl={class:"text-xl font-bold"},Vl={class:"bg-white/20 rounded-lg p-3"},$l={class:"text-xl font-bold"},Il={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Pl={class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Dl={class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Bl={key:1,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm space-y-6"},Ul={class:"flex items-center justify-between mb-4"},zl={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},Hl=["onUpdate:modelValue","value"],Rl={class:"ml-3"},_l={class:"font-medium text-gray-800"},Ol={class:"text-xs text-gray-500"},Fl={class:"relative"},Tl=["max"],El={class:"text-xs text-gray-500 mt-1"},Nl=["value"],Xl={class:"flex gap-3"},ql=["disabled"],Wl={key:2,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm space-y-6"},Yl={class:"flex items-center justify-between mb-4"},Gl={class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Jl={key:0,class:"space-y-3"},Kl={class:"flex items-center justify-between"},Ql={class:"font-semibold text-gray-800"},Zl={class:"text-sm text-gray-500"},er={class:"text-right"},tr={class:"text-lg font-bold text-green-600"},ar={key:1,class:"text-center py-8 text-gray-500"},lr=R({__name:"HousingFund",emits:["switch-tab"],setup(e,{emit:t}){const a=t,l=Z(),r=z(),s=c(null),o=u(()=>r.userInfo.accounts||[]),n=c(!1),d=c({type:"",amount:0,receiveAccount:""}),f=c(!1),S=[{value:"rent",label:"租房提取",description:"用于支付房租"},{value:"purchase",label:"购房提取",description:"用于购买住房"},{value:"repayment",label:"还贷提取",description:"用于偿还房贷"},{value:"retirement",label:"退休提取",description:"退休后一次性提取"}],V=c([]),$=u(()=>{var e;return d.value.type&&d.value.amount>0&&d.value.amount<=((null==(e=s.value)?void 0:e.balance)||0)&&d.value.receiveAccount}),I=e=>{if(!e)return"-";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},P=()=>i(this,null,function*(){try{yield l.applyHousingFundWithdrawal({type:d.value.type,amount:d.value.amount,receiveAccount:d.value.receiveAccount}),window.$notify.success({title:"申请成功",message:"提取申请已提交，审核通过后1-3个工作日内到账",duration:5e3}),n.value=!1,d.value={type:"",amount:0,receiveAccount:""},yield l.fetchHousingFundInfo(),s.value=l.housingFundInfo}catch(e){window.$notify.error({title:"申请失败",message:e.message||"提取申请失败，请稍后重试",duration:5e3})}}),D=()=>{a("switch-tab","large-loan")};return m(()=>i(this,null,function*(){try{yield l.fetchHousingFundInfo(),s.value=l.housingFundInfo,yield r.fetchUserInfo(),V.value=[]}catch(e){}})),(e,t)=>{var a,l;return v(),p("div",wl,[s.value?(v(),p("div",kl,[g("div",Cl,[g("div",null,[t[7]||(t[7]=g("p",{class:"text-white/80 text-sm mb-1"},"公积金账户余额",-1)),g("p",Ll,"¥"+y(s.value.balance.toLocaleString()),1),g("p",jl,"账户编号："+y(s.value.accountNumber),1)]),t[8]||(t[8]=g("svg",{class:"w-16 h-16 text-white/30",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1))]),g("div",Ml,[g("div",Al,[t[9]||(t[9]=g("p",{class:"text-white/80 text-xs mb-1"},"月缴存额",-1)),g("p",Sl,"¥"+y(s.value.monthlyDeposit.toLocaleString()),1)]),g("div",Vl,[t[10]||(t[10]=g("p",{class:"text-white/80 text-xs mb-1"},"可贷额度",-1)),g("p",$l,"¥"+y(s.value.loanLimit.toLocaleString()),1)])])])):L("",!0),g("div",Il,[g("div",Pl,[t[11]||(t[11]=g("h3",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center"},[g("svg",{class:"w-5 h-5 text-green-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})]),A(" 公积金提取 ")],-1)),g("button",{onClick:t[0]||(t[0]=e=>n.value=!0),class:"w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium"}," 申请提取 ")]),g("div",Dl,[t[12]||(t[12]=g("h3",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center"},[g("svg",{class:"w-5 h-5 text-blue-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),A(" 公积金贷款 ")],-1)),g("button",{onClick:t[1]||(t[1]=e=>f.value=!0),class:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium"}," 申请贷款 ")])]),n.value?(v(),p("div",Bl,[g("div",Ul,[t[14]||(t[14]=g("h3",{class:"text-lg font-semibold text-gray-800"},"公积金提取申请",-1)),g("button",{onClick:t[2]||(t[2]=e=>n.value=!1),class:"text-gray-400 hover:text-gray-600"},[...t[13]||(t[13]=[g("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),g("div",null,[t[15]||(t[15]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("提取类型"),g("span",{class:"text-red-500"},"*")],-1)),g("div",zl,[(v(),p(b,null,x(S,e=>g("label",{key:e.value,class:h(["flex items-center p-3 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",d.value.type===e.value?"border-primary bg-primary/5":"border-gray-200"])},[w(g("input",{type:"radio","onUpdate:modelValue":e=>d.value.type=e,value:e.value,class:"text-primary focus:ring-primary"},null,8,Hl),[[k,d.value.type]]),g("div",Rl,[g("p",_l,y(e.label),1),g("p",Ol,y(e.description),1)])],2)),64))])]),g("div",null,[t[17]||(t[17]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("提取金额（元）"),g("span",{class:"text-red-500"},"*")],-1)),g("div",Fl,[w(g("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>d.value.amount=e),max:(null==(a=s.value)?void 0:a.balance)||0,min:"0",step:"100",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"请输入提取金额"},null,8,Tl),[[C,d.value.amount,void 0,{number:!0}]]),t[16]||(t[16]=g("span",{class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500"},"元",-1))]),g("p",El,"可提取余额：¥"+y(((null==(l=s.value)?void 0:l.balance)||0).toLocaleString()),1)]),g("div",null,[t[19]||(t[19]=g("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[A("收款账户"),g("span",{class:"text-red-500"},"*")],-1)),w(g("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>d.value.receiveAccount=e),class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[t[18]||(t[18]=g("option",{value:""},"请选择收款账户",-1)),(v(!0),p(b,null,x(o.value,e=>(v(),p("option",{key:e.id,value:e.id},y(e.name)+" ("+y(e.number)+") ",9,Nl))),128))],512),[[j,d.value.receiveAccount]])]),t[20]||(t[20]=M('<div class="bg-blue-50 border-l-4 border-blue-400 rounded-lg p-4" data-v-eac2abac><div class="flex" data-v-eac2abac><svg class="w-5 h-5 text-blue-500 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-eac2abac><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-eac2abac></path></svg><div class="text-sm text-blue-700" data-v-eac2abac><p class="font-medium mb-1" data-v-eac2abac>提取说明</p><p data-v-eac2abac>提取申请提交后，系统将自动校验您的提取资格。审核通过后，资金将在1-3个工作日内到账。</p></div></div></div>',1)),g("div",Xl,[g("button",{onClick:t[5]||(t[5]=e=>n.value=!1),class:"flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," 取消 "),g("button",{onClick:P,disabled:!$.value,class:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 提交申请 ",8,ql)])])):L("",!0),f.value?(v(),p("div",Wl,[g("div",Yl,[t[22]||(t[22]=g("h3",{class:"text-lg font-semibold text-gray-800"},"公积金贷款申请",-1)),g("button",{onClick:t[6]||(t[6]=e=>f.value=!1),class:"text-gray-400 hover:text-gray-600"},[...t[21]||(t[21]=[g("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t[24]||(t[24]=g("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},[g("p",{class:"text-sm text-blue-800"},[g("span",{class:"font-semibold"},"提示："),A("公积金贷款申请将使用您的公积金缴存数据作为收入和信用证明，申请流程与大额贷款相同。 ")])],-1)),g("div",{class:"text-center py-8"},[t[23]||(t[23]=g("p",{class:"text-gray-600 mb-4"},"公积金贷款申请将跳转至大额贷款申请流程",-1)),g("button",{onClick:D,class:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium"}," 前往大额贷款申请 ")])])):L("",!0),g("div",Gl,[t[25]||(t[25]=g("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"提取记录",-1)),V.value.length>0?(v(),p("div",Jl,[(v(!0),p(b,null,x(V.value,e=>(v(),p("div",{key:e.id,class:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors"},[g("div",Kl,[g("div",null,[g("p",Ql,y(e.type),1),g("p",Zl,y(I(e.applyDate)),1)]),g("div",er,[g("p",tr,"¥"+y(e.amount.toLocaleString()),1),g("p",{class:h(["text-xs","success"===e.status?"text-green-600":"pending"===e.status?"text-amber-600":"text-gray-500"])},y("success"===e.status?"已到账":"pending"===e.status?"处理中":"失败"),3)])])]))),128))])):(v(),p("div",ar," 暂无提取记录 "))])])}}},[["__scopeId","data-v-eac2abac"]]),rr={class:"border-b border-gray-200 mb-6"},sr={class:"flex space-x-1 -mb-px"},or=["onClick"],nr={class:"flex items-center"},ir={class:"tab-content"},dr=R({__name:"LoanServices",setup(e){const t=I(),a=z(),l=c(!1),r=c("my-loans"),s=[{id:"my-loans",label:"我的贷款",icon:()=>U("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[U("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])},{id:"consumer-loan",label:"消费贷款",icon:()=>U("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[U("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])},{id:"large-loan",label:"大额贷款",icon:()=>U("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[U("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])},{id:"housing-fund",label:"公积金业务",icon:()=>U("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[U("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])}],o=e=>{r.value=e},n=()=>{a.clearNavigationState(),l.value=!1,setTimeout(()=>{t.push("/")},200)};return m(()=>{setTimeout(()=>{l.value=!0},50)}),(e,t)=>(v(),p("div",{class:"p-4 bg-white min-h-screen w-full transition-opacity duration-300",style:B({opacity:l.value?1:0})},[g("div",{class:"flex items-center justify-between mb-6"},[g("button",{onClick:n,class:"flex items-center space-x-2 text-primary hover:text-primary/80 transition-colors"},[...t[0]||(t[0]=[g("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[g("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),g("span",null,"返回账户中心",-1)])]),t[1]||(t[1]=g("h1",{class:"text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-gray-800"},"信贷服务",-1)),t[2]||(t[2]=g("div",{class:"w-28"},null,-1))]),g("div",rr,[g("nav",sr,[(v(),p(b,null,x(s,e=>g("button",{key:e.id,onClick:t=>r.value=e.id,class:h(["px-6 py-3 text-sm font-medium border-b-2 transition-colors",r.value===e.id?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[g("div",nr,[(v(),P(D(e.icon),{class:"w-5 h-5 mr-2"})),A(" "+y(e.label),1)])],10,or)),64))])]),g("div",ir,["my-loans"===r.value?(v(),P(nt,{key:0})):L("",!0),"consumer-loan"===r.value?(v(),P(la,{key:1})):L("",!0),"large-loan"===r.value?(v(),P(fl,{key:2})):L("",!0),"housing-fund"===r.value?(v(),P(lr,{key:3,onSwitchTab:o})):L("",!0)])],4))}},[["__scopeId","data-v-4f9bf457"]]);export{dr as default};
