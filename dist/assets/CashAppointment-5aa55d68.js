var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(a,t,r)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,n=(e,n)=>{for(var l in n||(n={}))t.call(n,l)&&s(e,l,n[l]);if(a)for(var l of a(n))r.call(n,l)&&s(e,l,n[l]);return e},l=(e,a,t)=>new Promise((r,s)=>{var n=e=>{try{o(t.next(e))}catch(a){s(a)}},l=e=>{try{o(t.throw(e))}catch(a){s(a)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,l);o((t=t.apply(e,a)).next())});import{u as o}from"./appointmentStore-57f46e49.js";import{M as i,r as d,N as c,a as u,b as m,c as p,l as v,u as g,t as b,s as x,y,C as f,E as h,m as w,B as k,j as C,I as S,n as T,D as E,H as I,F as M,z as N,e as j,x as $,J as B}from"./vue-vendor-4f5e579f.js";import{v as V,b as D}from"./api-f0b2653a.js";import{a as U}from"./axios-a8f987cd.js";import{_}from"./index-6eedd0a1.js";import{Q as A}from"./qrcode-4a20cae5.js";import"./authStore-7202ba10.js";function z(e){if(!e)return"";const a="string"==typeof e?new Date(e):e;if(isNaN(a.getTime()))return"";return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`}function O(e,a=2){if(null==e)return"0.00";const t="string"==typeof e?parseFloat(e):e;return isNaN(t)?"0.00":t.toLocaleString("zh-CN",{minimumFractionDigits:a,maximumFractionDigits:a})}function P(e){return!e||e.length<18?e:e.replace(/(\d{6})\d{8}(\d{4})/,"$1********$2")}function H(e){return!e||e.length<11?e:e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2")}U.create({baseURL:{}.VITE_API_BASE_URL||"/api",timeout:1e4,headers:{"Content-Type":"application/json"}});const q={class:"identity-verification-container space-y-6"},L={key:0,class:"flex justify-center items-center py-12"},R={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},F={class:"flex"},Y={class:"mt-2 text-sm text-red-700"},J={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-6 text-center"},X={class:"text-lg font-medium text-green-800 mb-2"},G={class:"mt-4 pt-4 border-t border-green-200"},K={class:"text-xs text-green-600"},W={key:3,class:"bg-white border border-gray-200 rounded-lg shadow-sm p-6"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},Z={class:"space-y-1"},ee={class:"space-y-1"},ae={key:0,class:"text-xs text-red-500 mt-1"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},re={class:"space-y-1"},se={key:0,class:"text-xs text-red-500 mt-1"},ne={class:"space-y-1"},le={class:"flex gap-3"},oe=["disabled"],ie={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-3"},de={class:"flex items-start"},ce={class:"text-sm text-blue-700"},ue={class:"mt-1"},me={class:"font-mono font-bold"},pe={class:"pt-4"},ve=["disabled"],ge={key:0,class:"flex items-center justify-center"},be={key:1},xe=_({__name:"Step1Identity",emits:["verified","next"],setup(e,{emit:a}){const t=o(),r=a,s=i("notification"),C={test001:{name:"张三",idCard:"110101199001011234",phone:"13800138000",verifyCode:"123456",customerId:"TEST_USER_001"},test002:{name:"李四",idCard:"110101199002022345",phone:"13900139000",verifyCode:"654321",customerId:"TEST_USER_002"}},S=d(!0),T=d(""),E=d(n({},t.userInfo)),I=c({name:"",idCard:"",phone:"",verifyCode:""}),M=d(!1),N=d(60),j=d(!1),$=d(""),B=d(""),U=d(""),_=d(!1),A=()=>l(this,null,function*(){try{S.value=!0,T.value="";const e=yield t.checkLoginStatus();e&&(E.value=e,t.setUserInfo(e),setTimeout(()=>{r("verified"),r("next")},2e3))}catch(e){T.value="身份验证初始化失败，请重试"}finally{S.value=!1}}),z=e=>{const a=e.target.value;if(a){const e=V(a);$.value=e.valid?"":e.message,e.valid&&I.phone&&H()}else $.value="",_.value=!1},O=e=>{const a=e.target.value;if(a){const e=D(a,I.idCard);B.value=e.valid?"":e.message,e.valid&&I.idCard&&H()}else B.value="",_.value=!1},H=()=>{const e=Object.values(C).find(e=>e.idCard===I.idCard&&e.phone===I.phone);return e?(_.value=!0,U.value=e.verifyCode,I.verifyCode=e.verifyCode,!0):(_.value=!1,!1)},xe=()=>l(this,null,function*(){const e=D(I.phone,I.idCard);if(!e.valid)return void(B.value=e.message);const a=H();try{if(M.value=!0,a)return null==s||s.success("测试账户：验证码已自动填充"),void(M.value=!1);const e=yield(t=I.phone,new Promise((e,a)=>{setTimeout(()=>{/^1[3-9]\d{9}$/.test(t)?e({success:!0,message:"验证码已发送，请注意查收",requestId:Math.random().toString(36).substr(2,9)}):a(new Error("请输入有效的手机号码"))},800)}));if(e.success){null==s||s.success("验证码已发送，请查收短信");const e=setInterval(()=>{N.value--,N.value<=0&&(clearInterval(e),M.value=!1,N.value=60)},1e3)}else null==s||s.error(e.message||"发送验证码失败，请重试"),M.value=!1}catch(r){null==s||s.error("发送验证码失败，请稍后重试"),M.value=!1}var t}),ye=()=>l(this,null,function*(){if(!I.name||0===I.name.trim().length)return void(null==s||s.error("请输入姓名"));const e=V(I.idCard);if(!e.valid)return $.value=e.message,void(null==s||s.error(e.message));const a=D(I.phone,I.idCard);if(!a.valid)return B.value=a.message,void(null==s||s.error(a.message));var n;if(I.verifyCode&&0!==I.verifyCode.length)try{j.value=!0;const e=Object.values(C).find(e=>e.idCard===I.idCard&&e.phone===I.phone&&e.verifyCode===I.verifyCode);let a;a=e?{success:!0,message:"身份验证成功（测试账户）",data:{customerId:e.customerId,name:e.name,idCard:e.idCard,phone:e.phone,token:"TEST_TOKEN_"+Date.now()}}:yield(n=I,new Promise((e,a)=>{setTimeout(()=>{const t={"110101199001011234":{phone:"13800138000",verifyCode:"123456",name:"张三",customerId:"TEST_USER_001"},"110101199002022345":{phone:"13900139000",verifyCode:"654321",name:"李四",customerId:"TEST_USER_002"}}[n.idCard];if(t&&t.phone===n.phone)return t.verifyCode!==n.smsCode?void a(new Error("验证码错误")):void e({success:!0,message:"身份验证成功（测试账户）",data:{customerId:t.customerId,name:t.name||n.name,idCard:n.idCard,phone:n.phone,token:"TEST_TOKEN_"+Date.now()}});n.name&&0!==n.name.trim().length?/^\d{17}[\dXx]$/.test(n.idCard)?/^1[3-9]\d{9}$/.test(n.phone)?n.smsCode&&6===n.smsCode.length?e({success:!0,message:"身份验证成功",data:{customerId:`VISITOR_${Math.random().toString(36).substr(2,10).toUpperCase()}`,name:n.name,idCard:n.idCard,phone:n.phone,token:Math.random().toString(36).substr(2,16)}}):a(new Error("请输入6位验证码")):a(new Error("请输入有效的手机号码")):a(new Error("请输入有效的身份证号码")):a(new Error("请输入姓名"))},1e3)})),a.success?(t.setUserInfo({name:a.data.name||I.name,idCard:a.data.idCard||I.idCard,phone:a.data.phone||I.phone,isLoggedIn:!1,customerId:a.data.customerId}),null==s||s.success("身份验证成功"),setTimeout(()=>{r("verified"),r("next")},500)):(T.value=a.message||"身份验证失败，请检查信息后重试",null==s||s.error(T.value))}catch(l){T.value=l.message||"验证过程中发生错误，请稍后重试",null==s||s.error(T.value)}finally{j.value=!1}else null==s||s.error("请输入验证码")});return u(()=>{A()}),(e,a)=>(m(),p("div",q,[a[21]||(a[21]=v("div",{class:"text-center"},[v("h2",{class:"text-xl font-semibold text-gray-900"},"身份验证"),v("p",{class:"mt-2 text-sm text-gray-500"},"请完成身份验证以继续预约流程")],-1)),S.value?(m(),p("div",L,[...a[4]||(a[4]=[g('<div class="text-center" data-v-cff0d83b><svg class="animate-spin -ml-1 mr-2 h-10 w-10 text-primary" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-cff0d83b><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-cff0d83b></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-cff0d83b></path></svg><p class="text-gray-500" data-v-cff0d83b>验证中...</p></div>',1)])])):T.value?(m(),p("div",R,[v("div",F,[a[6]||(a[6]=v("svg",{class:"w-5 h-5 text-red-500 mr-3 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),v("div",null,[a[5]||(a[5]=v("h3",{class:"text-sm font-medium text-red-800"},"验证失败",-1)),v("div",Y,[v("p",null,b(T.value),1),v("button",{onClick:A,class:"text-primary hover:underline ml-2"},"重试")])])])])):E.value.isLoggedIn?(m(),p("div",J,[a[10]||(a[10]=v("div",{class:"mb-4"},[v("svg",{class:"w-12 h-12 text-green-500 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),v("h3",X," 欢迎您，"+b(E.value.name)+b("male"===E.value.gender?"先生":"female"===E.value.gender?"女士":(E.value.name,"")),1),a[11]||(a[11]=v("p",{class:"mt-2 text-sm text-green-700"},"身份信息已验证，正在为您准备预约表单...",-1)),v("div",G,[v("p",K,[a[7]||(a[7]=v("span",{class:"font-medium"},"姓名：",-1)),x(b(E.value.name)+" | ",1),a[8]||(a[8]=v("span",{class:"font-medium"},"身份证号：",-1)),x(b(y(P)(E.value.idCard))+" | ",1),a[9]||(a[9]=v("span",{class:"font-medium"},"客户号：",-1)),x(b(E.value.customerId||"未设置"),1)])])])):(m(),p("div",W,[a[20]||(a[20]=v("div",{class:"mb-6"},[v("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"访客预约"),v("p",{class:"text-sm text-gray-500"},"请填写以下信息进行身份验证")],-1)),v("form",{onSubmit:k(ye,["prevent"]),class:"space-y-5"},[v("div",Q,[v("div",Z,[a[12]||(a[12]=v("label",{for:"visitorName",class:"block text-sm font-medium text-gray-700"},[x(" 姓名 "),v("span",{class:"text-red-500"},"*")],-1)),f(v("input",{type:"text",id:"visitorName","onUpdate:modelValue":a[0]||(a[0]=e=>I.name=e),required:"",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors",placeholder:"请输入真实姓名",maxlength:"20"},null,512),[[h,I.name]])]),v("div",ee,[a[13]||(a[13]=v("label",{for:"visitorIdCard",class:"block text-sm font-medium text-gray-700"},[x(" 身份证号 "),v("span",{class:"text-red-500"},"*")],-1)),f(v("input",{type:"text",id:"visitorIdCard","onUpdate:modelValue":a[1]||(a[1]=e=>I.idCard=e),required:"",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors",placeholder:"请输入18位身份证号",maxlength:"18",onInput:z},null,544),[[h,I.idCard]]),$.value?(m(),p("p",ae,b($.value),1)):w("",!0)])]),v("div",te,[v("div",re,[a[14]||(a[14]=v("label",{for:"visitorPhone",class:"block text-sm font-medium text-gray-700"},[x(" 手机号码 "),v("span",{class:"text-red-500"},"*")],-1)),f(v("input",{type:"tel",id:"visitorPhone","onUpdate:modelValue":a[2]||(a[2]=e=>I.phone=e),required:"",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors",placeholder:"请输入银行预留手机号",maxlength:"11",onInput:O},null,544),[[h,I.phone]]),B.value?(m(),p("p",se,b(B.value),1)):w("",!0)]),v("div",ne,[a[15]||(a[15]=v("label",{for:"verifyCode",class:"block text-sm font-medium text-gray-700"},[x(" 短信验证码 "),v("span",{class:"text-red-500"},"*")],-1)),v("div",le,[f(v("input",{type:"text",id:"verifyCode","onUpdate:modelValue":a[3]||(a[3]=e=>I.verifyCode=e),required:"",class:"flex-1 px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors",placeholder:"请输入6位验证码",maxlength:"6"},null,512),[[h,I.verifyCode]]),v("button",{type:"button",onClick:xe,disabled:M.value||!I.phone||B.value,class:"px-6 py-2.5 whitespace-nowrap bg-primary text-white rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium"},b(M.value?`${N.value}秒后重发`:"获取验证码"),9,oe)])])]),_.value?(m(),p("div",ie,[v("div",de,[a[18]||(a[18]=v("svg",{class:"w-5 h-5 text-blue-500 mr-2 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),v("div",ce,[a[17]||(a[17]=v("p",{class:"font-medium"},"测试账户模式",-1)),v("p",ue,[a[16]||(a[16]=x("您正在使用内部测试账户，验证码为：",-1)),v("span",me,b(U.value),1)])])])])):w("",!0),v("div",pe,[v("button",{type:"submit",disabled:j.value,class:"w-full bg-primary text-white py-3 px-4 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium text-base"},[j.value?(m(),p("span",ge,[...a[19]||(a[19]=[v("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[v("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),v("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),x(" 验证中... ",-1)])])):(m(),p("span",be,"验证并继续"))],8,ve)])],32)]))]))}},[["__scopeId","data-v-cff0d83b"]]),ye={class:"space-y-6"},fe={key:0,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},we={class:"flex items-center"},ke=["checked"],Ce={class:"flex items-center"},Se=["checked"],Te={class:"flex items-center"},Ee=["checked"],Ie={key:1,class:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm"},Me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ne={class:"flex items-center"},je={class:"flex items-center"},$e={key:2,class:"bg-white border border-gray-200 rounded-xl p-6 space-y-5 shadow-sm"},Be={key:0},Ve={class:"space-y-5"},De={class:"relative"},Ue={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},_e={class:"relative"},Ae={class:"relative"},ze={class:"relative"},Oe={class:"relative"},Pe={class:"relative"},He={class:"relative"},qe={class:"mt-4"},Le={class:"relative"},Re={key:1},Fe={class:"space-y-5"},Ye={class:"relative"},Je={class:"flex items-center p-3 bg-gray-50 rounded-lg"},Xe={class:"space-y-3"},Ge={class:"flex items-center p-3 bg-gray-50 rounded-lg"},Ke=["disabled"],We={class:"flex items-center p-3 bg-gray-50 rounded-lg"},Qe=["disabled"],Ze={class:"flex items-center p-3 bg-gray-50 rounded-lg"},ea={class:"relative"},aa=["disabled"],ta={key:0,class:"flex items-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg"},ra={key:2},sa={class:"space-y-5"},na={class:"space-y-3"},la={class:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors"},oa={class:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors"},ia={class:"relative"},da={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},ca={key:3},ua={class:"space-y-5"},ma={class:"relative"},pa={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},va={class:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors"},ga={class:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors"},ba={class:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors"},xa={class:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors"},ya={key:3,class:"bg-gradient-to-r from-primary/10 to-primary/5 border border-primary/20 rounded-xl p-5 mt-6 animate-fadeIn"},fa={class:"text-sm text-gray-700 space-y-2"},ha={key:0},wa={class:"ml-2"},ka={class:"ml-2 text-primary font-semibold"},Ca={key:1},Sa={class:"ml-2"},Ta={key:2},Ea={key:3},Ia={class:"flex justify-between mt-8 pt-6 border-t border-gray-200"},Ma=["disabled"],Na=_({__name:"Step2Business",emits:["prev","next"],setup(e,{emit:a}){const t=a,r=o(),s=d(!1),l=d(""),i=d(""),y=c({amount:null,denominations:{100:null,50:null,20:null,10:null,5:null,1:null},coins:null,denominationPreferences:{100:!1,50:!1,20:!1},needSmallChange:!1,smallChangeAmount:null,exchangeDirection:"noteToChange",damageTypes:[],hasAdvancedBooking:!1,isNewNoteExchange:!1}),k={deposit:"存款",withdrawal:"取款",changeExchange:"零钱兑换",damagedExchange:"残币兑换",exchange:"零钱残币兑换"},M=C(()=>"exchange"===l.value&&i.value?k[i.value]||"":k[l.value]||""),N=C(()=>!!l.value&&(!("exchange"===l.value&&!i.value)&&!(!y.amount||y.amount<=0))),j=e=>{l.value=e,"exchange"===e?i.value="":($(e),r.setBusinessInfo({type:e,details:{}}))};u(()=>{const e=r.businessInfo;if(null==e?void 0:e.type)"changeExchange"===e.type||"damagedExchange"===e.type?(l.value="exchange",i.value=e.type):l.value=e.type,e.details&&Object.assign(y,n({hasAdvancedBooking:!1,isNewNoteExchange:!1,exchangeDirection:"noteToChange"},e.details));else{const e=r.serviceType;"deposit"===e||"withdrawal"===e?(l.value=e,r.setBusinessInfo({type:e,details:{}})):"change"===e?l.value="exchange":"new-notes"===e&&(l.value="withdrawal",y.isNewNoteExchange=!0,r.setBusinessInfo({type:"withdrawal",details:{isNewNoteExchange:!0}}))}}),S(i,e=>{e&&$(e)});const $=e=>{if(e)switch(y.amount=null,y.denominations=Object.fromEntries(Object.keys(y.denominations).map(e=>[e,null])),e){case"deposit":y.coins=null;break;case"withdrawal":y.denominationPreferences={100:!1,50:!1,20:!1},y.needSmallChange=!1,y.smallChangeAmount=null,y.hasAdvancedBooking=!1,y.isNewNoteExchange=!1;break;case"changeExchange":y.exchangeDirection="noteToChange";break;case"damagedExchange":y.damageTypes=[];break;default:y.coins=null,y.denominationPreferences={100:!1,50:!1,20:!1},y.needSmallChange=!1,y.smallChangeAmount=null,y.exchangeDirection="noteToChange",y.damageTypes=[],y.hasAdvancedBooking=!1,y.isNewNoteExchange=!1}};S([l,i,y],()=>{const e="exchange"===l.value?i.value:l.value;e&&r.setBusinessInfo({type:e,details:n({},y)})},{deep:!0});const B=()=>{try{const e=Object.entries(y.denominations).filter(([,e])=>e>0).map(([e,a])=>`${e}元 x ${a}张`);return y.coins>0&&e.push(`硬币 ¥${y.coins.toFixed(2)}`),e.join(", ")||"未指定"}catch(e){return"计算错误"}},V=C(()=>Object.values(y.denominations).some(e=>e>0)),D=C(()=>y.coins>0),U=()=>{var e;try{let a=!0,o="";if(s.value)return void window.$notify.warning({title:"提示",message:"操作进行中，请稍后再试",duration:3e3});const d="exchange"===l.value?i.value:l.value;if(!d)return void window.$notify.error({title:"表单验证失败",message:"请选择业务类型",duration:5e3});s.value=!0,y.amount&&(y.amount=parseFloat(y.amount.toFixed(2)));for(const e in y.denominations)null!==y.denominations[e]&&(y.denominations[e]=Math.floor(Math.abs(y.denominations[e]))||null);if(!y.amount||isNaN(y.amount)||y.amount<=0?(a=!1,o="请输入有效的金额"):y.amount>1e6?(a=!1,o="单笔交易金额不能超过100万元"):(null==(e=y.amount.toString().split(".")[1])?void 0:e.length)>2&&(a=!1,o="金额最多只能保留两位小数"),"deposit"===d||"withdrawal"===d&&y.amount>=5e4&&!y.hasAdvancedBooking&&(a=!1,o="5万元及以上取款需提前一天预约，请勾选已预约选项"),!a)return window.$notify.error({title:"表单验证失败",message:o,duration:5e3}),void(s.value=!1);r.setBusinessInfo({type:d,details:n({},y),status:"completed",updatedAt:(new Date).toISOString()}),t("next"),s.value=!1}catch(a){window.$notify.error({title:"系统错误",message:"处理请求时发生错误，请稍后重试",duration:5e3}),s.value=!1}};return(e,a)=>(m(),p("div",ye,[a[104]||(a[104]=v("div",{class:"text-center"},[v("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"业务信息填写"),v("p",{class:"text-sm text-gray-600"},"请填写您需要办理的业务详细信息")],-1)),l.value?w("",!0):(m(),p("div",fe,[a[45]||(a[45]=v("h3",{class:"text-base font-semibold text-gray-800 mb-4 flex items-center"},[v("svg",{class:"w-5 h-5 text-primary mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),x(" 请选择业务类型 ")],-1)),v("div",he,[v("div",{class:T(["p-4 border-2 rounded-lg cursor-pointer transition-all hover:shadow-md","deposit"===l.value?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"]),onClick:a[0]||(a[0]=e=>j("deposit"))},[v("div",we,[v("input",{type:"radio",id:"selectDeposit",checked:"deposit"===l.value,class:"h-4 w-4 text-primary focus:ring-primary border-gray-300"},null,8,ke),a[39]||(a[39]=v("label",{for:"selectDeposit",class:"ml-3 block text-sm font-medium text-gray-700 cursor-pointer flex-1"}," 存款 ",-1))]),a[40]||(a[40]=v("p",{class:"text-xs text-gray-500 mt-2 ml-7"},"现金存入账户",-1))],2),v("div",{class:T(["p-4 border-2 rounded-lg cursor-pointer transition-all hover:shadow-md","withdrawal"===l.value?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"]),onClick:a[1]||(a[1]=e=>j("withdrawal"))},[v("div",Ce,[v("input",{type:"radio",id:"selectWithdrawal",checked:"withdrawal"===l.value,class:"h-4 w-4 text-primary focus:ring-primary border-gray-300"},null,8,Se),a[41]||(a[41]=v("label",{for:"selectWithdrawal",class:"ml-3 block text-sm font-medium text-gray-700 cursor-pointer flex-1"}," 取款 ",-1))]),a[42]||(a[42]=v("p",{class:"text-xs text-gray-500 mt-2 ml-7"},"从账户提取现金",-1))],2),v("div",{class:T(["p-4 border-2 rounded-lg cursor-pointer transition-all hover:shadow-md","exchange"===l.value?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"]),onClick:a[2]||(a[2]=e=>j("exchange"))},[v("div",Te,[v("input",{type:"radio",id:"selectExchange",checked:"exchange"===l.value,class:"h-4 w-4 text-primary focus:ring-primary border-gray-300"},null,8,Ee),a[43]||(a[43]=v("label",{for:"selectExchange",class:"ml-3 block text-sm font-medium text-gray-700 cursor-pointer flex-1"}," 零钱残币兑换 ",-1))]),a[44]||(a[44]=v("p",{class:"text-xs text-gray-500 mt-2 ml-7"},"零钱或残币兑换服务",-1))],2)])])),"exchange"===l.value?(m(),p("div",Ie,[a[50]||(a[50]=v("h3",{class:"text-base font-semibold text-gray-800 mb-4 flex items-center"},[v("svg",{class:"w-5 h-5 text-primary mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})]),x(" 请选择兑换类型 ")],-1)),v("div",Me,[v("div",{class:T(["p-4 border-2 rounded-lg cursor-pointer transition-all hover:shadow-md","changeExchange"===i.value?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"]),onClick:a[4]||(a[4]=e=>i.value="changeExchange")},[v("div",Ne,[f(v("input",{type:"radio",id:"changeExchange","onUpdate:modelValue":a[3]||(a[3]=e=>i.value=e),value:"changeExchange",class:"h-4 w-4 text-primary focus:ring-primary border-gray-300"},null,512),[[E,i.value]]),a[46]||(a[46]=v("label",{for:"changeExchange",class:"ml-3 block text-sm font-medium text-gray-700 cursor-pointer flex-1"}," 零钱兑换 ",-1))]),a[47]||(a[47]=v("p",{class:"text-xs text-gray-500 mt-2 ml-7"},"整钞与零钱互换",-1))],2),v("div",{class:T(["p-4 border-2 rounded-lg cursor-pointer transition-all hover:shadow-md","damagedExchange"===i.value?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"]),onClick:a[6]||(a[6]=e=>i.value="damagedExchange")},[v("div",je,[f(v("input",{type:"radio",id:"damagedExchange","onUpdate:modelValue":a[5]||(a[5]=e=>i.value=e),value:"damagedExchange",class:"h-4 w-4 text-primary focus:ring-primary border-gray-300"},null,512),[[E,i.value]]),a[48]||(a[48]=v("label",{for:"damagedExchange",class:"ml-3 block text-sm font-medium text-gray-700 cursor-pointer flex-1"}," 残币兑换 ",-1))]),a[49]||(a[49]=v("p",{class:"text-xs text-gray-500 mt-2 ml-7"},"破损币换新币",-1))],2)])])):w("",!0),"exchange"!==l.value||i.value?(m(),p("div",$e,["deposit"===l.value?(m(),p("div",Be,[a[62]||(a[62]=v("h3",{class:"text-base font-semibold text-gray-800 mb-4 flex items-center"},[v("svg",{class:"w-5 h-5 text-primary mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),x(" 存款业务详情 ")],-1)),v("div",Ve,[v("div",null,[a[52]||(a[52]=v("label",{for:"depositAmount",class:"block text-sm font-medium text-gray-700 mb-2"},[x(" 预计存款总额："),v("span",{class:"text-red-500"},"*")],-1)),v("div",De,[f(v("input",{type:"number",id:"depositAmount","onUpdate:modelValue":a[7]||(a[7]=e=>y.amount=e),min:"0",step:"0.01",required:"",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all",placeholder:"请输入预计存款金额"},null,512),[[h,y.amount,void 0,{number:!0}]]),a[51]||(a[51]=v("span",{class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500"},"元",-1))])]),v("div",null,[a[60]||(a[60]=v("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," 主要面额构成（估算，可选填） ",-1)),v("div",Ue,[v("div",null,[a[53]||(a[53]=v("label",{for:"denomination100",class:"block text-xs text-gray-500 mb-1"},"100元",-1)),v("div",_e,[f(v("input",{type:"number",id:"denomination100","onUpdate:modelValue":a[8]||(a[8]=e=>y.denominations[100]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[100],void 0,{number:!0}]])])]),v("div",null,[a[54]||(a[54]=v("label",{for:"denomination50",class:"block text-xs text-gray-500 mb-1"},"50元",-1)),v("div",Ae,[f(v("input",{type:"number",id:"denomination50","onUpdate:modelValue":a[9]||(a[9]=e=>y.denominations[50]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[50],void 0,{number:!0}]])])]),v("div",null,[a[55]||(a[55]=v("label",{for:"denomination20",class:"block text-xs text-gray-500 mb-1"},"20元",-1)),v("div",ze,[f(v("input",{type:"number",id:"denomination20","onUpdate:modelValue":a[10]||(a[10]=e=>y.denominations[20]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[20],void 0,{number:!0}]])])]),v("div",null,[a[56]||(a[56]=v("label",{for:"denomination10",class:"block text-xs text-gray-500 mb-1"},"10元",-1)),v("div",Oe,[f(v("input",{type:"number",id:"denomination10","onUpdate:modelValue":a[11]||(a[11]=e=>y.denominations[10]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[10],void 0,{number:!0}]])])]),v("div",null,[a[57]||(a[57]=v("label",{for:"denomination5",class:"block text-xs text-gray-500 mb-1"},"5元",-1)),v("div",Pe,[f(v("input",{type:"number",id:"denomination5","onUpdate:modelValue":a[12]||(a[12]=e=>y.denominations[5]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[5],void 0,{number:!0}]])])]),v("div",null,[a[58]||(a[58]=v("label",{for:"denomination1",class:"block text-xs text-gray-500 mb-1"},"1元",-1)),v("div",He,[f(v("input",{type:"number",id:"denomination1","onUpdate:modelValue":a[13]||(a[13]=e=>y.denominations[1]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[1],void 0,{number:!0}]])])])]),v("div",qe,[a[59]||(a[59]=v("label",{for:"coins",class:"block text-xs text-gray-500 mb-1"},"硬币",-1)),v("div",Le,[f(v("input",{type:"number",id:"coins","onUpdate:modelValue":a[14]||(a[14]=e=>y.coins=e),min:"0",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"元"},null,512),[[h,y.coins,void 0,{number:!0}]])])])]),a[61]||(a[61]=g('<div class="bg-blue-50 border-l-4 border-blue-400 rounded-lg p-4" data-v-197675b6><div class="flex" data-v-197675b6><svg class="w-5 h-5 text-blue-500 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-197675b6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-197675b6></path></svg><p class="text-sm text-blue-700" data-v-197675b6>为提高办理效率，建议您提前将纸币按面额分类整理。</p></div></div>',1))])])):w("",!0),"withdrawal"===l.value?(m(),p("div",Re,[a[72]||(a[72]=v("h3",{class:"text-base font-semibold text-gray-800 mb-4 flex items-center"},[v("svg",{class:"w-5 h-5 text-primary mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})]),x(" 取款业务详情 ")],-1)),v("div",Fe,[v("div",null,[a[64]||(a[64]=v("label",{for:"withdrawalAmount",class:"block text-sm font-medium text-gray-700 mb-2"},[x(" 预计取款总额："),v("span",{class:"text-red-500"},"*")],-1)),v("div",Ye,[f(v("input",{type:"number",id:"withdrawalAmount","onUpdate:modelValue":a[15]||(a[15]=e=>y.amount=e),min:"0",step:"0.01",required:"",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all",placeholder:"请输入预计取款金额"},null,512),[[h,y.amount,void 0,{number:!0}]]),a[63]||(a[63]=v("span",{class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500"},"元",-1))])]),v("div",Je,[f(v("input",{type:"checkbox",id:"isNewNoteExchange","onUpdate:modelValue":a[16]||(a[16]=e=>y.isNewNoteExchange=e),class:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[I,y.isNewNoteExchange]]),a[65]||(a[65]=v("label",{for:"isNewNoteExchange",class:"ml-2 block text-sm text-gray-700 cursor-pointer flex-1"}," 是否兑换新钞 ",-1))]),v("div",null,[a[69]||(a[69]=v("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," 所需面额偏好（视库存情况满足） ",-1)),v("div",Xe,[v("div",Ge,[f(v("input",{type:"checkbox",id:"need100","onUpdate:modelValue":a[17]||(a[17]=e=>y.denominationPreferences[100]=e),class:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[I,y.denominationPreferences[100]]]),a[66]||(a[66]=v("label",{for:"need100",class:"ml-2 block text-sm text-gray-700 flex-1"},"需要100元面额",-1)),f(v("input",{type:"number","onUpdate:modelValue":a[18]||(a[18]=e=>y.denominations[100]=e),min:"0",class:"w-24 px-3 py-1.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张",disabled:!y.denominationPreferences[100]},null,8,Ke),[[h,y.denominations[100],void 0,{number:!0}]])]),v("div",We,[f(v("input",{type:"checkbox",id:"need50","onUpdate:modelValue":a[19]||(a[19]=e=>y.denominationPreferences[50]=e),class:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[I,y.denominationPreferences[50]]]),a[67]||(a[67]=v("label",{for:"need50",class:"ml-2 block text-sm text-gray-700 flex-1"},"需要50元面额",-1)),f(v("input",{type:"number","onUpdate:modelValue":a[20]||(a[20]=e=>y.denominations[50]=e),min:"0",class:"w-24 px-3 py-1.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张",disabled:!y.denominationPreferences[50]},null,8,Qe),[[h,y.denominations[50],void 0,{number:!0}]])]),v("div",Ze,[f(v("input",{type:"checkbox",id:"needSmallChange","onUpdate:modelValue":a[21]||(a[21]=e=>y.needSmallChange=e),class:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[I,y.needSmallChange]]),a[68]||(a[68]=v("label",{for:"needSmallChange",class:"ml-2 block text-sm text-gray-700 flex-1"},"需要20元及以下零钞",-1)),v("div",ea,[f(v("input",{type:"number","onUpdate:modelValue":a[22]||(a[22]=e=>y.smallChangeAmount=e),min:"0",step:"0.01",class:"w-24 px-3 py-1.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"元",disabled:!y.needSmallChange},null,8,aa),[[h,y.smallChangeAmount,void 0,{number:!0}]])])])])]),y.amount>=5e4?(m(),p("div",ta,[f(v("input",{type:"checkbox",id:"hasAdvancedBooking","onUpdate:modelValue":a[23]||(a[23]=e=>y.hasAdvancedBooking=e),class:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[I,y.hasAdvancedBooking]]),a[70]||(a[70]=v("label",{for:"hasAdvancedBooking",class:"ml-2 block text-sm text-gray-700"}," 我已提前一天预约大额取款 ",-1))])):w("",!0),a[71]||(a[71]=g('<div class="bg-amber-50 border-l-4 border-amber-400 rounded-lg p-4" data-v-197675b6><div class="flex" data-v-197675b6><svg class="w-5 h-5 text-amber-500 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-197675b6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" data-v-197675b6></path></svg><p class="text-sm text-amber-700" data-v-197675b6>大额取现（如超过5万元）请提前一天预约，以便支行为您备足现金。</p></div></div>',1))])])):w("",!0),"changeExchange"===i.value?(m(),p("div",ra,[a[86]||(a[86]=v("h3",{class:"text-base font-semibold text-gray-800 mb-4 flex items-center"},[v("svg",{class:"w-5 h-5 text-primary mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})]),x(" 零钱兑换业务详情 ")],-1)),v("div",sa,[v("div",null,[a[75]||(a[75]=v("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"兑换方向",-1)),v("div",na,[v("div",la,[f(v("input",{type:"radio",id:"changeToNote","onUpdate:modelValue":a[24]||(a[24]=e=>y.exchangeDirection=e),value:"changeToNote",class:"h-4 w-4 text-primary focus:ring-primary border-gray-300"},null,512),[[E,y.exchangeDirection]]),a[73]||(a[73]=v("label",{for:"changeToNote",class:"ml-3 block text-sm text-gray-700 cursor-pointer flex-1"}," 零钱换整钞（提交零钱信息） ",-1))]),v("div",oa,[f(v("input",{type:"radio",id:"noteToChange","onUpdate:modelValue":a[25]||(a[25]=e=>y.exchangeDirection=e),value:"noteToChange",class:"h-4 w-4 text-primary focus:ring-primary border-gray-300"},null,512),[[E,y.exchangeDirection]]),a[74]||(a[74]=v("label",{for:"noteToChange",class:"ml-3 block text-sm text-gray-700 cursor-pointer flex-1"}," 整钞换零钱（提交所需零钱信息） ",-1))])])]),v("div",null,[a[77]||(a[77]=v("label",{for:"exchangeAmount",class:"block text-sm font-medium text-gray-700 mb-2"},[x(" 总金额："),v("span",{class:"text-red-500"},"*")],-1)),v("div",ia,[f(v("input",{type:"number",id:"exchangeAmount","onUpdate:modelValue":a[26]||(a[26]=e=>y.amount=e),min:"0",step:"0.01",required:"",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all",placeholder:"请输入兑换总金额"},null,512),[[h,y.amount,void 0,{number:!0}]]),a[76]||(a[76]=v("span",{class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500"},"元",-1))])]),v("div",null,[a[84]||(a[84]=v("label",{class:"block text-sm font-medium text-gray-700 mb-3"}," 面额与数量明细（尽可能填写） ",-1)),v("div",da,[v("div",null,[a[78]||(a[78]=v("label",{for:"change100",class:"block text-xs text-gray-500 mb-1"},"100元",-1)),f(v("input",{type:"number",id:"change100","onUpdate:modelValue":a[27]||(a[27]=e=>y.denominations[100]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[100],void 0,{number:!0}]])]),v("div",null,[a[79]||(a[79]=v("label",{for:"change50",class:"block text-xs text-gray-500 mb-1"},"50元",-1)),f(v("input",{type:"number",id:"change50","onUpdate:modelValue":a[28]||(a[28]=e=>y.denominations[50]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[50],void 0,{number:!0}]])]),v("div",null,[a[80]||(a[80]=v("label",{for:"change20",class:"block text-xs text-gray-500 mb-1"},"20元",-1)),f(v("input",{type:"number",id:"change20","onUpdate:modelValue":a[29]||(a[29]=e=>y.denominations[20]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[20],void 0,{number:!0}]])]),v("div",null,[a[81]||(a[81]=v("label",{for:"change10",class:"block text-xs text-gray-500 mb-1"},"10元",-1)),f(v("input",{type:"number",id:"change10","onUpdate:modelValue":a[30]||(a[30]=e=>y.denominations[10]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[10],void 0,{number:!0}]])]),v("div",null,[a[82]||(a[82]=v("label",{for:"change5",class:"block text-xs text-gray-500 mb-1"},"5元",-1)),f(v("input",{type:"number",id:"change5","onUpdate:modelValue":a[31]||(a[31]=e=>y.denominations[5]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[5],void 0,{number:!0}]])]),v("div",null,[a[83]||(a[83]=v("label",{for:"change1",class:"block text-xs text-gray-500 mb-1"},"1元",-1)),f(v("input",{type:"number",id:"change1","onUpdate:modelValue":a[32]||(a[32]=e=>y.denominations[1]=e),min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"张"},null,512),[[h,y.denominations[1],void 0,{number:!0}]])])])]),a[85]||(a[85]=g('<div class="bg-blue-50 border-l-4 border-blue-400 rounded-lg p-4" data-v-197675b6><div class="flex" data-v-197675b6><svg class="w-5 h-5 text-blue-500 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-197675b6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-197675b6></path></svg><p class="text-sm text-blue-700" data-v-197675b6>零钱数量巨大时，清点可能需要较长时间，感谢您的理解与耐心。</p></div></div>',1))])])):w("",!0),"damagedExchange"===i.value?(m(),p("div",ca,[a[95]||(a[95]=v("h3",{class:"text-base font-semibold text-gray-800 mb-4 flex items-center"},[v("svg",{class:"w-5 h-5 text-primary mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),x(" 残币兑换业务详情 ")],-1)),v("div",ua,[v("div",null,[a[88]||(a[88]=v("label",{for:"damagedAmount",class:"block text-sm font-medium text-gray-700 mb-2"},[x(" 预计破损纸币总额（大致估算）："),v("span",{class:"text-red-500"},"*")],-1)),v("div",ma,[f(v("input",{type:"number",id:"damagedAmount","onUpdate:modelValue":a[33]||(a[33]=e=>y.amount=e),min:"0",step:"0.01",required:"",class:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all",placeholder:"请输入预计总额"},null,512),[[h,y.amount,void 0,{number:!0}]]),a[87]||(a[87]=v("span",{class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500"},"元",-1))])]),v("div",null,[a[93]||(a[93]=v("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"破损类型（可多选）",-1)),v("div",pa,[v("div",va,[f(v("input",{type:"checkbox",id:"damageTear","onUpdate:modelValue":a[34]||(a[34]=e=>y.damageTypes=e),value:"tear",class:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[I,y.damageTypes]]),a[89]||(a[89]=v("label",{for:"damageTear",class:"ml-2 block text-sm text-gray-700 cursor-pointer flex-1"},"撕裂/缺损",-1))]),v("div",ga,[f(v("input",{type:"checkbox",id:"damageStain","onUpdate:modelValue":a[35]||(a[35]=e=>y.damageTypes=e),value:"stain",class:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[I,y.damageTypes]]),a[90]||(a[90]=v("label",{for:"damageStain",class:"ml-2 block text-sm text-gray-700 cursor-pointer flex-1"},"污损/涂画",-1))]),v("div",ba,[f(v("input",{type:"checkbox",id:"damageBurn","onUpdate:modelValue":a[36]||(a[36]=e=>y.damageTypes=e),value:"burn",class:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[I,y.damageTypes]]),a[91]||(a[91]=v("label",{for:"damageBurn",class:"ml-2 block text-sm text-gray-700 cursor-pointer flex-1"},"火烧/水浸",-1))]),v("div",xa,[f(v("input",{type:"checkbox",id:"damageInsect","onUpdate:modelValue":a[37]||(a[37]=e=>y.damageTypes=e),value:"insect",class:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"},null,512),[[I,y.damageTypes]]),a[92]||(a[92]=v("label",{for:"damageInsect",class:"ml-2 block text-sm text-gray-700 cursor-pointer flex-1"},"虫蛀",-1))])])]),a[94]||(a[94]=g('<div class="bg-blue-50 border-l-4 border-blue-400 rounded-lg p-4" data-v-197675b6><div class="flex" data-v-197675b6><svg class="w-5 h-5 text-blue-500 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-197675b6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-197675b6></path></svg><p class="text-sm text-blue-700" data-v-197675b6>根据人民银行规定，破损币的兑换有具体标准，最终金额以柜面实际鉴定为准。</p></div></div>',1))])])):w("",!0)])):w("",!0),y.amount&&("exchange"!==l.value||i.value)?(m(),p("div",ya,[a[101]||(a[101]=v("h4",{class:"text-sm font-semibold text-gray-800 mb-3 flex items-center"},[v("svg",{class:"w-4 h-4 text-primary mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),x(" 业务信息摘要 ")],-1)),v("div",fa,[M.value?(m(),p("p",ha,[a[96]||(a[96]=v("span",{class:"font-medium text-gray-800"},"业务类型:",-1)),v("span",wa,b(M.value),1)])):w("",!0),v("p",null,[a[97]||(a[97]=v("span",{class:"font-medium text-gray-800"},"办理金额:",-1)),v("span",ka,"¥"+b(y.amount.toFixed(2)),1)]),"deposit"===l.value&&(V.value||D.value)?(m(),p("p",Ca,[a[98]||(a[98]=v("span",{class:"font-medium text-gray-800"},"面额构成:",-1)),v("span",Sa,b(B()),1)])):w("",!0),"withdrawal"===l.value&&y.isNewNoteExchange?(m(),p("p",Ta,[...a[99]||(a[99]=[v("span",{class:"font-medium text-gray-800"},"兑换新钞:",-1),v("span",{class:"ml-2 text-green-600"},"是",-1)])])):w("",!0),"withdrawal"===l.value&&y.amount>=5e4?(m(),p("p",Ea,[a[100]||(a[100]=v("span",{class:"font-medium text-gray-800"},"大额预约:",-1)),v("span",{class:T(["ml-2",y.hasAdvancedBooking?"text-green-600":"text-amber-600"])},b(y.hasAdvancedBooking?"✓ 已预约":"✗ 未预约"),3)])):w("",!0)])])):w("",!0),v("div",Ia,[v("button",{type:"button",onClick:a[38]||(a[38]=e=>t("prev")),class:"inline-flex items-center px-6 py-2.5 border-2 border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all"},[...a[102]||(a[102]=[v("svg",{class:"-ml-1 mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),x(" 上一步 ",-1)])]),v("button",{type:"button",onClick:U,disabled:!N.value,class:"inline-flex items-center px-6 py-2.5 border-2 border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[...a[103]||(a[103]=[x(" 下一步：选择网点和时间 ",-1),v("svg",{class:"ml-2 -mr-1 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})],-1)])],8,Ma)])]))}},[["__scopeId","data-v-197675b6"]]),ja={class:"branch-time-container space-y-6"},$a={key:0,class:"flex justify-center items-center py-12"},Ba={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},Va={class:"flex"},Da={class:"mt-2 text-sm text-red-700"},Ua={key:2,class:"space-y-4"},_a={class:"border rounded-lg p-5"},Aa={class:"space-y-3"},za=["onClick"],Oa={class:"flex items-start justify-between"},Pa={class:"flex-1"},Ha={class:"flex items-center gap-2 mb-2"},qa={class:"font-medium text-gray-900"},La={key:0,class:"px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded"},Ra={class:"text-sm text-gray-600 mb-1"},Fa={class:"text-sm text-gray-600 mb-1"},Ya={class:"flex items-center gap-4 mt-2 text-xs text-gray-500"},Ja={key:0},Xa={class:"mt-2 text-xs text-gray-500"},Ga={key:0,class:"ml-4"},Ka={key:0,class:"border rounded-lg p-5"},Wa={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},Qa=["onClick","disabled"],Za={class:"text-xs mt-1"},et={key:1,class:"border rounded-lg p-5"},at={key:0,class:"text-center py-4"},tt={key:1,class:"text-center py-4 text-gray-500"},rt={key:2,class:"grid grid-cols-2 md:grid-cols-3 gap-3"},st=["onClick","disabled"],nt={class:"flex justify-between mt-8"},lt=["disabled"],ot=_({__name:"Step3BranchTime",emits:["prev","next"],setup(e,{emit:a}){const t=o(),r=a,s=d(!1),n=d(""),i=d([]),c=d(null),y=d(""),f=d(""),h=d([]),k=d(!1),E=C(()=>{const e=[],a=new Date;for(let t=0;t<7;t++){const r=new Date(a);r.setDate(a.getDate()+t);const s=["周日","周一","周二","周三","周四","周五","周六"][r.getDay()],n=String(r.getMonth()+1).padStart(2,"0"),l=String(r.getDate()).padStart(2,"0"),o=`${n}-${l}`,i=`${r.getFullYear()}-${n}-${l}`;e.push({label:0===t?"今天":1===t?"明天":s,dateStr:o,value:i,disabled:!1})}return e}),I=()=>l(this,null,function*(){try{s.value=!0,n.value="";const e=[{id:"branch_001",name:"河北银行总行营业部",address:"河北省石家庄市长安区中山东路216号",phone:"0311-88888888",distance:2.5,queueCount:15,businessHours:"周一至周五 09:00-17:00，周六 09:00-12:00",largeCashSupport:!0,newNotesSupport:!0},{id:"branch_002",name:"河北银行城东支行",address:"河北省石家庄市裕华区建华南大街88号",phone:"0311-88888889",distance:5.2,queueCount:8,businessHours:"周一至周五 09:00-17:00，周六 09:00-12:00",largeCashSupport:!0,newNotesSupport:!1},{id:"branch_003",name:"河北银行城西支行",address:"河北省石家庄市桥西区中山西路188号",phone:"0311-88888890",distance:3.8,queueCount:12,businessHours:"周一至周五 09:00-17:00，周六 09:00-12:00",largeCashSupport:!1,newNotesSupport:!1},{id:"branch_004",name:"河北银行城南支行",address:"河北省石家庄市桥西区新石中路266号",phone:"0311-88888891",distance:6.5,queueCount:5,businessHours:"周一至周五 09:00-17:00",largeCashSupport:!0,newNotesSupport:!1},{id:"branch_005",name:"河北银行城北支行",address:"河北省石家庄市新华区和平西路298号",phone:"0311-88888892",distance:4.3,queueCount:10,businessHours:"周一至周五 09:00-17:00，周六 09:00-12:00",largeCashSupport:!1,newNotesSupport:!1}];if(i.value=e,t.branchInfo.id){const e=i.value.find(e=>e.id===t.branchInfo.id);e&&(c.value=e)}t.appointmentDate&&(y.value=t.appointmentDate),t.appointmentTime&&(f.value=t.appointmentTime)}catch(e){n.value="获取网点信息失败，请刷新页面重试"}finally{s.value=!1}}),j=()=>l(this,null,function*(){var e;if(c.value&&y.value)try{k.value=!0;const e=[{value:"09:00-09:30",label:"09:00-09:30",available:!0},{value:"09:30-10:00",label:"09:30-10:00",available:!0},{value:"10:00-10:30",label:"10:00-10:30",available:!0},{value:"10:30-11:00",label:"10:30-11:00",available:!0},{value:"11:00-11:30",label:"11:00-11:30",available:!0},{value:"11:30-12:00",label:"11:30-12:00",available:!0},{value:"14:00-14:30",label:"14:00-14:30",available:!0},{value:"14:30-15:00",label:"14:30-15:00",available:!0},{value:"15:00-15:30",label:"15:00-15:30",available:!0},{value:"15:30-16:00",label:"15:30-16:00",available:!0},{value:"16:00-16:30",label:"16:00-16:30",available:!0},{value:"16:30-17:00",label:"16:30-17:00",available:!0}],a=Math.floor(3*Math.random());for(let t=0;t<a;t++){e[Math.floor(Math.random()*e.length)].available=!1}if(h.value=e,t.appointmentTime){const e=h.value.find(e=>e.value===t.appointmentTime);e&&e.available&&(f.value=e.value)}}catch(a){null==(e=window.$notify)||e.error("获取可用时段失败，请稍后重试")}finally{k.value=!1}}),$=()=>{var e;c.value&&y.value&&f.value?r("next"):null==(e=window.$notify)||e.error("请完整选择网点、日期和时间段")};return S([c,y],()=>{c.value&&y.value&&j()}),u(()=>{I()}),(e,a)=>(m(),p("div",ja,[a[16]||(a[16]=v("div",{class:"text-center"},[v("h2",{class:"text-xl font-semibold text-gray-900"},"选择线下营业厅与时间"),v("p",{class:"mt-2 text-sm text-gray-500"},"请选择办理网点及预约时间")],-1)),s.value?(m(),p("div",$a,[...a[1]||(a[1]=[g('<div class="text-center" data-v-bee6386b><svg class="animate-spin -ml-1 mr-2 h-10 w-10 text-primary" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-bee6386b><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-bee6386b></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-bee6386b></path></svg><p class="text-gray-500" data-v-bee6386b>加载网点信息中...</p></div>',1)])])):n.value?(m(),p("div",Ba,[v("div",Va,[a[3]||(a[3]=v("svg",{class:"w-5 h-5 text-red-500 mr-3 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),v("div",null,[a[2]||(a[2]=v("h3",{class:"text-sm font-medium text-red-800"},"加载失败",-1)),v("div",Da,[v("p",null,b(n.value),1),v("button",{onClick:I,class:"text-primary hover:underline ml-2"},"重试")])])])])):(m(),p("div",Ua,[v("div",_a,[a[10]||(a[10]=v("h3",{class:"text-sm font-medium text-gray-700 mb-4"},"选择网点",-1)),v("div",Aa,[(m(!0),p(M,null,N(i.value,e=>{var r,s;return m(),p("div",{key:e.id,onClick:a=>(e=>{c.value=e,t.setBranchInfo(e),y.value="",f.value="",h.value=[]})(e),class:T(["border rounded-lg p-4 cursor-pointer transition-all",(null==(r=c.value)?void 0:r.id)===e.id?"border-primary bg-primary/5 shadow-md":"border-gray-200 hover:border-gray-300 hover:shadow-sm"])},[v("div",Oa,[v("div",Pa,[v("div",Ha,[v("h4",qa,b(e.name),1),e.largeCashSupport?(m(),p("span",La," 支持大额 ")):w("",!0)]),v("p",Ra,[a[4]||(a[4]=v("svg",{class:"w-4 h-4 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),x(" "+b(e.address),1)]),v("p",Fa,[a[5]||(a[5]=v("svg",{class:"w-4 h-4 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),x(" 电话："+b(e.phone),1)]),v("div",Ya,[v("span",null,[a[6]||(a[6]=v("svg",{class:"w-4 h-4 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),x(" 今日排队："+b(e.queueCount)+"人 ",1)]),e.distance>0?(m(),p("span",Ja,[a[7]||(a[7]=v("svg",{class:"w-4 h-4 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),x(" 距离："+b(e.distance)+"km ",1)])):w("",!0)]),v("div",Xa,[a[8]||(a[8]=v("p",{class:"font-medium mb-1"},"营业时间：",-1)),v("p",null,b(e.businessHours),1)])]),(null==(s=c.value)?void 0:s.id)===e.id?(m(),p("div",Ga,[...a[9]||(a[9]=[v("svg",{class:"w-6 h-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])])):w("",!0)])],10,za)}),128))])]),c.value?(m(),p("div",Ka,[a[11]||(a[11]=v("h3",{class:"text-sm font-medium text-gray-700 mb-4"},"选择办理日期",-1)),v("div",Wa,[(m(!0),p(M,null,N(E.value,e=>(m(),p("button",{key:e.value,onClick:a=>(e=>{y.value=e,t.setAppointmentDate(e),f.value="",j()})(e.value),class:T(["px-4 py-2 rounded-md text-sm font-medium transition-all",y.value===e.value?"bg-primary text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200",e.disabled?"opacity-50 cursor-not-allowed":""]),disabled:e.disabled},[v("div",null,b(e.label),1),v("div",Za,b(e.dateStr),1)],10,Qa))),128))])])):w("",!0),c.value&&y.value?(m(),p("div",et,[a[13]||(a[13]=v("h3",{class:"text-sm font-medium text-gray-700 mb-4"},"选择时间段",-1)),k.value?(m(),p("div",at,[...a[12]||(a[12]=[v("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-primary inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[v("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),v("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),v("span",{class:"text-gray-500"},"加载可用时段...",-1)])])):0===h.value.length?(m(),p("div",tt," 该日期暂无可用时段 ")):(m(),p("div",rt,[(m(!0),p(M,null,N(h.value,e=>(m(),p("button",{key:e.value,onClick:a=>{return r=e.value,f.value=r,void t.setAppointmentTime(r);var r},class:T(["px-4 py-2 rounded-md text-sm font-medium transition-all",f.value===e.value?"bg-primary text-white shadow-md":e.available?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-gray-50 text-gray-400 cursor-not-allowed opacity-50"]),disabled:!e.available},b(e.label),11,st))),128))]))])):w("",!0)])),v("div",nt,[v("button",{type:"button",onClick:a[0]||(a[0]=e=>r("prev")),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"},[...a[14]||(a[14]=[v("svg",{class:"-ml-1 mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),x(" 上一步 ",-1)])]),v("button",{type:"button",onClick:$,disabled:!c.value||!y.value||!f.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed"},[...a[15]||(a[15]=[x(" 下一步：确认预约信息 ",-1),v("svg",{class:"ml-2 -mr-1 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})],-1)])],8,lt)])]))}},[["__scopeId","data-v-bee6386b"]]),it={class:"confirmation-container space-y-6"},dt={class:"border rounded-lg overflow-hidden"},ct={class:"p-5 space-y-4"},ut={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},mt={class:"font-medium"},pt={class:"font-medium"},vt={class:"font-medium"},gt={class:"font-medium text-primary"},bt={class:"pt-4 border-t"},xt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},yt={class:"font-medium"},ft={class:"font-medium"},ht={key:0,class:"mt-4 p-3 bg-gray-50 rounded-md"},wt={class:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-sm"},kt={class:"text-gray-500"},Ct={class:"font-medium ml-1"},St={key:0},Tt={class:"font-medium ml-1"},Et={class:"pt-4 border-t"},It={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Mt={class:"font-medium"},Nt={class:"font-medium"},jt={class:"md:col-span-2"},$t={class:"font-medium"},Bt={class:"text-sm text-gray-500 mt-1"},Vt={class:"flex justify-between"},Dt=["disabled"],Ut={key:0},_t={key:1},At=_({__name:"Step4Confirmation",emits:["confirmed","back"],setup(e,{emit:a}){const t=o(),r=a,s=d(!1),n=C(()=>{const e=new Date;return`XJ${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}${Math.floor(1e4*Math.random()).toString().padStart(4,"0")}`}),i=C(()=>t.userInfo),c=C(()=>t.businessInfo),u=C(()=>t.branchInfo),f=C(()=>t.appointmentDate),h=C(()=>t.appointmentTime),k=C(()=>t.businessTypeName),S=C(()=>{const e=c.value.details||{},a=e.denominations||{};return Object.values(a).some(e=>e>0)||(e.coins||0)>0}),T=C(()=>{const e=(c.value.details||{}).denominations||{},a={};return Object.entries(e).forEach(([e,t])=>{t>0&&(a[e]=t)}),a}),E=()=>l(this,null,function*(){var e;try{s.value=!0;const e={appointmentNo:n.value,userId:i.value.customerId||"visitor",userName:i.value.name,idCard:i.value.idCard,phone:i.value.phone,businessType:c.value.type,businessTypeName:k.value,amount:c.value.details.amount,denominations:c.value.details.denominations,coins:c.value.details.coins,branchId:u.value.id,branchName:u.value.name,appointmentDate:f.value,appointmentTime:h.value,status:"pending",createdAt:(new Date).toISOString()},a=yield function(e){return new Promise((a,t)=>{setTimeout(()=>{e.businessType?!e.amount||e.amount<=0?t(new Error("请输入有效的金额")):e.branchId?e.appointmentDate?a({success:!0,message:"预约提交成功",data:{appointmentId:`APPT_${Date.now()}_${Math.floor(1e3*Math.random()).toString().padStart(3,"0")}`,appointmentNo:`XN${Date.now().toString().substr(-8)}${Math.floor(1e4*Math.random()).toString().padStart(4,"0")}`,qrCodeUrl:`/api/qrcode/${Date.now()}.png`,appointmentTime:(new Date).toISOString()}}):t(new Error("请选择预约日期")):t(new Error("请选择预约网点")):t(new Error("请选择业务类型"))},1200)})}(e);if(!a.success)throw new Error(a.message||"预约提交失败，请重试");t.setAppointmentNo(n.value),setTimeout(()=>{var e;null==(e=window.$notify)||e.success("预约成功，已发送短信通知")},500),r("confirmed",n.value)}catch(a){null==(e=window.$notify)||e.error(a.message||"预约提交失败，请稍后重试"),s.value=!1}});return(e,a)=>(m(),p("div",it,[a[16]||(a[16]=v("div",{class:"text-center"},[v("h2",{class:"text-xl font-semibold text-gray-900"},"确认预约信息"),v("p",{class:"mt-2 text-sm text-gray-500"},"请确认以下预约信息，无误后提交")],-1)),v("div",dt,[a[13]||(a[13]=v("div",{class:"bg-gray-50 px-5 py-3 border-b"},[v("h3",{class:"font-medium text-gray-800"},"预约详情")],-1)),v("div",ct,[v("div",ut,[v("div",null,[a[1]||(a[1]=v("p",{class:"text-sm text-gray-500"},"姓名",-1)),v("p",mt,b(i.value.name),1)]),v("div",null,[a[2]||(a[2]=v("p",{class:"text-sm text-gray-500"},"身份证号",-1)),v("p",pt,b(y(P)(i.value.idCard)),1)]),v("div",null,[a[3]||(a[3]=v("p",{class:"text-sm text-gray-500"},"联系电话",-1)),v("p",vt,b(y(H)(i.value.phone)),1)]),v("div",null,[a[4]||(a[4]=v("p",{class:"text-sm text-gray-500"},"预约编号",-1)),v("p",gt,b(n.value),1)])]),v("div",bt,[a[9]||(a[9]=v("p",{class:"text-sm text-gray-500 mb-2"},"业务信息",-1)),v("div",xt,[v("div",null,[a[5]||(a[5]=v("p",{class:"text-sm text-gray-500"},"业务类型",-1)),v("p",yt,b(k.value),1)]),v("div",null,[a[6]||(a[6]=v("p",{class:"text-sm text-gray-500"},"金额",-1)),v("p",ft,b(y(O)(c.value.details.amount))+" 元",1)])]),S.value?(m(),p("div",ht,[a[8]||(a[8]=v("p",{class:"text-sm font-medium text-gray-700 mb-2"},"面额详情",-1)),v("div",wt,[(m(!0),p(M,null,N(T.value,(e,a)=>(m(),p("div",{key:a},[v("span",kt,b(a)+"元:",1),v("span",Ct,b(e)+" "+b(a>=1?"张":"个"),1)]))),128)),c.value.details.coins>0?(m(),p("div",St,[a[7]||(a[7]=v("span",{class:"text-gray-500"},"硬币:",-1)),v("span",Tt,b(c.value.details.coins)+" 元",1)])):w("",!0)])])):w("",!0)]),v("div",Et,[v("div",It,[v("div",null,[a[10]||(a[10]=v("p",{class:"text-sm text-gray-500"},"预约日期",-1)),v("p",Mt,b(y(z)(f.value)),1)]),v("div",null,[a[11]||(a[11]=v("p",{class:"text-sm text-gray-500"},"预约时段",-1)),v("p",Nt,b(h.value),1)]),v("div",jt,[a[12]||(a[12]=v("p",{class:"text-sm text-gray-500"},"预约网点",-1)),v("p",$t,b(u.value.name),1),v("p",Bt,b(u.value.address)+" | 电话: "+b(u.value.phone),1)])])])])]),a[17]||(a[17]=g('<div class="bg-blue-50 border border-blue-200 rounded-lg p-4" data-v-c45497be><h3 class="text-sm font-medium text-blue-800 flex items-center" data-v-c45497be><svg class="w-5 h-5 text-blue-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c45497be><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-c45497be></path></svg> 注意事项 </h3><ul class="mt-2 text-sm text-blue-700 space-y-1" data-v-c45497be><li class="flex items-start" data-v-c45497be><span class="text-blue-500 mr-2" data-v-c45497be>•</span><span data-v-c45497be>请携带本人有效身份证件及银行卡前往办理</span></li><li class="flex items-start" data-v-c45497be><span class="text-blue-500 mr-2" data-v-c45497be>•</span><span data-v-c45497be>如需取消预约，请提前2小时操作</span></li><li class="flex items-start" data-v-c45497be><span class="text-blue-500 mr-2" data-v-c45497be>•</span><span data-v-c45497be>大额取款（超过5万元）请确保已提前一天预约</span></li></ul></div>',1)),v("div",Vt,[v("button",{class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",onClick:a[0]||(a[0]=e=>r("back"))},[...a[14]||(a[14]=[v("svg",{class:"-ml-1 mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),x(" 返回修改 ",-1)])]),v("button",{class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50",onClick:E,disabled:s.value},[s.value?(m(),p("span",Ut,[...a[15]||(a[15]=[v("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[v("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),v("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),x(" 提交中... ",-1)])])):(m(),p("span",_t,"确认提交"))],8,Dt)])]))}},[["__scopeId","data-v-c45497be"]]),zt={class:"success-container text-center py-8 px-4"},Ot={class:"text-gray-500 mb-4"},Pt={class:"max-w-md mx-auto bg-white rounded-lg shadow-sm p-6 mb-8"},Ht={class:"flex flex-col md:flex-row items-center justify-between gap-6"},qt={class:"bg-white p-2 border rounded-md"},Lt={class:"text-left"},Rt={class:"mb-3"},Ft={class:"text-lg font-semibold text-primary"},Yt={class:"space-y-1 text-sm"},Jt={class:"flex justify-between"},Xt={class:"font-medium"},Gt={class:"flex justify-between"},Kt={class:"font-medium"},Wt={class:"flex justify-between"},Qt={class:"font-medium"},Zt={class:"flex justify-between"},er={class:"font-medium"},ar=_({__name:"Step5Success",setup(e){const a=o(),t=C(()=>a.appointmentNo),r=C(()=>a.businessTypeName),s=C(()=>a.appointmentDate),n=C(()=>a.appointmentTime),l=C(()=>{var e;return(null==(e=a.branchInfo)?void 0:e.name)||""}),i=C(()=>{var e,t;return(null==(t=null==(e=a.businessInfo)?void 0:e.details)?void 0:t.amount)||0}),d=C(()=>JSON.stringify({type:"cash_appointment",appointmentNo:t.value,name:a.userInfo.name,date:s.value,time:n.value,branch:l.value})),c=()=>{var e,a;try{const a=n.value.split("-")[0],o=n.value.split("-")[1],d=new Date(`${s.value}T${a}`),c=new Date(`${s.value}T${o}`),m=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//河北银行//预约系统//CN","BEGIN:VEVENT",`UID:${t.value}@hebbank.com`,`DTSTART:${u(d)}`,`DTEND:${u(c)}`,`SUMMARY:现金业务预约 - ${r.value}`,`DESCRIPTION:预约编号: ${t.value}\\n业务类型: ${r.value}\\n金额: ${i.value}元\\n网点: ${l.value}`,`LOCATION:${l.value}`,"STATUS:CONFIRMED","END:VEVENT","END:VCALENDAR"].join("\r\n"),p=new Blob([m],{type:"text/calendar;charset=utf-8"}),v=document.createElement("a");v.href=URL.createObjectURL(p),v.download=`预约-${t.value}.ics`,v.click(),null==(e=window.$notify)||e.success("日历文件已下载，请导入到您的日历应用")}catch(o){null==(a=window.$notify)||a.error("添加日历失败，请稍后重试")}},u=e=>`${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}${String(e.getMinutes()).padStart(2,"0")}${String(e.getSeconds()).padStart(2,"0")}`,f=()=>{window.print()};return(e,a)=>(m(),p("div",zt,[a[11]||(a[11]=v("div",{class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"},[v("svg",{class:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),a[12]||(a[12]=v("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"预约成功",-1)),v("p",Ot,"您的"+b(r.value)+"预约已提交成功，请凭预约码到店办理",1),a[13]||(a[13]=v("p",{class:"text-sm text-gray-400 mb-8"},"系统已发送预约成功通知，请注意查收短信",-1)),v("div",Pt,[v("div",Ht,[v("div",qt,[j(A,{value:d.value,size:120,level:"H",class:"qrcode"},null,8,["value"])]),v("div",Lt,[v("div",Rt,[a[0]||(a[0]=v("p",{class:"text-sm text-gray-500"},"预约编号",-1)),v("p",Ft,b(t.value),1)]),v("div",Yt,[v("p",Jt,[a[1]||(a[1]=v("span",{class:"text-gray-500"},"业务类型：",-1)),a[2]||(a[2]=x()),v("span",Xt,b(r.value),1)]),v("p",Gt,[a[3]||(a[3]=v("span",{class:"text-gray-500"},"预约日期：",-1)),a[4]||(a[4]=x()),v("span",Kt,b(y(z)(s.value)),1)]),v("p",Wt,[a[5]||(a[5]=v("span",{class:"text-gray-500"},"预约时段：",-1)),a[6]||(a[6]=x()),v("span",Qt,b(n.value),1)]),v("p",Zt,[a[7]||(a[7]=v("span",{class:"text-gray-500"},"办理网点：",-1)),a[8]||(a[8]=x()),v("span",er,b(l.value),1)])])])])]),v("div",{class:"flex flex-col sm:flex-row justify-center gap-4"},[v("button",{class:"inline-flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",onClick:c},[...a[9]||(a[9]=[v("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),x(" 添加到手机日历 ",-1)])]),v("button",{class:"inline-flex items-center px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",onClick:f},[...a[10]||(a[10]=[v("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1),x(" 打印凭证 ",-1)])])]),a[14]||(a[14]=g('<div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md mx-auto" data-v-8c7854a2><h3 class="text-sm font-medium text-blue-800 mb-2" data-v-8c7854a2>温馨提示</h3><ul class="text-sm text-blue-700 space-y-1" data-v-8c7854a2><li class="flex items-start" data-v-8c7854a2><span class="text-blue-500 mr-2" data-v-8c7854a2>•</span><span data-v-8c7854a2>请务必携带本人有效身份证件及银行卡前往办理</span></li><li class="flex items-start" data-v-8c7854a2><span class="text-blue-500 mr-2" data-v-8c7854a2>•</span><span data-v-8c7854a2>如需取消预约，请提前2小时通过原预约渠道操作</span></li><li class="flex items-start" data-v-8c7854a2><span class="text-blue-500 mr-2" data-v-8c7854a2>•</span><span data-v-8c7854a2>预约码有效期为预约日期当天，请按时前往办理</span></li><li class="flex items-start" data-v-8c7854a2><span class="text-blue-500 mr-2" data-v-8c7854a2>•</span><span data-v-8c7854a2>系统将在预约时间前1-2小时发送提醒短信</span></li></ul></div>',1))]))}},[["__scopeId","data-v-8c7854a2"]]),tr={class:"cash-appointment-container"},rr={class:"steps-container"},sr={class:"steps-indicator"},nr={class:"step-content"},lr=_({__name:"CashAppointment",setup(e){const a=o();$();const t=d(1),r=d(!0),s=d(""),n=d(!1),i=()=>l(this,null,function*(){try{r.value=!0;(yield a.checkUserStatus()).isLoggedIn&&(t.value=2),s.value=""}catch(e){s.value="预约流程初始化失败，请刷新页面重试"}finally{r.value=!1}}),c=()=>{t.value<5&&(t.value++,window.scrollTo({top:0,behavior:"smooth"}))},g=()=>{t.value>1&&(t.value--,window.scrollTo({top:0,behavior:"smooth"}))},b=()=>l(this,null,function*(){var e;n.value=!0;try{t.value=5,setTimeout(()=>{var e;null==(e=window.$notify)||e.success("预约成功，已发送短信通知")},1e3)}catch(a){null==(e=window.$notify)||e.error("预约提交失败，请稍后重试")}finally{n.value=!1}}),x=e=>{var a;s.value=e.message||"操作失败，请稍后重试",null==(a=window.$notify)||a.error({title:"错误",message:s.value,duration:5e3})};return S(t,e=>{a.setCurrentStep(e);const t=(e-1)/4*100;document.documentElement.style.setProperty("--progress",`${t}%`)},{immediate:!0}),u(()=>{i()}),(e,a)=>(m(),p("div",tr,[a[5]||(a[5]=v("h1",{class:"text-2xl font-bold mb-6"},"现金业务预约",-1)),v("div",rr,[v("div",sr,[v("div",{class:T(["step-item",t.value>=1?"active":""])},[...a[0]||(a[0]=[v("div",{class:"step-number"},"1",-1),v("div",{class:"step-name"},"身份验证",-1)])],2),v("div",{class:T(["step-item",t.value>=2?"active":""])},[...a[1]||(a[1]=[v("div",{class:"step-number"},"2",-1),v("div",{class:"step-name"},"业务信息",-1)])],2),v("div",{class:T(["step-item",t.value>=3?"active":""])},[...a[2]||(a[2]=[v("div",{class:"step-number"},"3",-1),v("div",{class:"step-name"},"网点与时间",-1)])],2),v("div",{class:T(["step-item",t.value>=4?"active":""])},[...a[3]||(a[3]=[v("div",{class:"step-number"},"4",-1),v("div",{class:"step-name"},"确认提交",-1)])],2),v("div",{class:T(["step-item",t.value>=5?"active":""])},[...a[4]||(a[4]=[v("div",{class:"step-number"},"5",-1),v("div",{class:"step-name"},"预约成功",-1)])],2)]),v("div",nr,[1===t.value?(m(),B(xe,{key:0,onNext:c,onError:x})):w("",!0),2===t.value?(m(),B(Na,{key:1,onNext:c,onPrev:g})):w("",!0),3===t.value?(m(),B(ot,{key:2,onNext:c,onPrev:g})):w("",!0),4===t.value?(m(),B(At,{key:3,onConfirmed:b,onBack:g})):w("",!0),5===t.value?(m(),B(ar,{key:4})):w("",!0)])])]))}},[["__scopeId","data-v-567b95d9"]]);export{lr as default};
